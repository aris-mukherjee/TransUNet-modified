/scratch_net/biwidl217_second/arismu/Master_Thesis_Codes/project_TransUNet/TransUNet/utils.py:894: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if mask_type is 'squares_jigsaw':
/scratch_net/biwidl217_second/arismu/Master_Thesis_Codes/project_TransUNet/TransUNet/utils.py:901: SyntaxWarning: "is" with a literal. Did you mean "=="?
  elif mask_type is 'squares_zeros':
2021-11-25 16:58:23,663 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='UCL', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='UCL', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='UCL', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='UCL', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-25 16:58:23,664 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-25 16:58:23,667 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-25 16:58:41,711 ============================================================
============================================================
2021-11-25 16:58:41,712 Subject 1 out of 11: case29
Subject 1 out of 11: case29
2021-11-25 16:58:45,285 case 0 mean_dice 0.669874 mean_hd95 15.673218
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 53183
GtSum: 50526
Predsum: 53183
GtSum: 50526
Predsum: 53183
GtSum: 50526
case 0 mean_dice 0.669874 mean_hd95 15.673218
2021-11-25 16:58:45,519 ============================================================
============================================================
2021-11-25 16:58:45,519 Subject 2 out of 11: case33
Subject 2 out of 11: case33
2021-11-25 16:58:48,770 case 1 mean_dice 0.571585 mean_hd95 35.017852
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 41370
GtSum: 27974
Predsum: 41370
GtSum: 27974
Predsum: 41370
GtSum: 27974
case 1 mean_dice 0.571585 mean_hd95 35.017852
2021-11-25 16:58:48,975 ============================================================
============================================================
2021-11-25 16:58:48,975 Subject 3 out of 11: case26
Subject 3 out of 11: case26
2021-11-25 16:58:52,213 case 2 mean_dice 0.718623 mean_hd95 16.803267
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 41680
GtSum: 41390
Predsum: 41680
GtSum: 41390
Predsum: 41680
GtSum: 41390
case 2 mean_dice 0.718623 mean_hd95 16.803267
2021-11-25 16:58:52,419 ============================================================
============================================================
2021-11-25 16:58:52,420 Subject 4 out of 11: case32
Subject 4 out of 11: case32
2021-11-25 16:58:55,639 case 3 mean_dice 0.519511 mean_hd95 33.111176
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 34895
GtSum: 20919
Predsum: 34895
GtSum: 20919
Predsum: 34895
GtSum: 20919
case 3 mean_dice 0.519511 mean_hd95 33.111176
2021-11-25 16:58:55,843 ============================================================
============================================================
2021-11-25 16:58:55,844 Subject 5 out of 11: case35
Subject 5 out of 11: case35
2021-11-25 16:58:59,041 case 4 mean_dice 0.667709 mean_hd95 24.166092
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 27104
GtSum: 24679
Predsum: 27104
GtSum: 24679
Predsum: 27104
GtSum: 24679
case 4 mean_dice 0.667709 mean_hd95 24.166092
2021-11-25 16:58:59,244 ============================================================
============================================================
2021-11-25 16:58:59,244 Subject 6 out of 11: case30
Subject 6 out of 11: case30
2021-11-25 16:59:02,475 case 5 mean_dice 0.564355 mean_hd95 22.803509
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 54713
GtSum: 34752
Predsum: 54713
GtSum: 34752
Predsum: 54713
GtSum: 34752
case 5 mean_dice 0.564355 mean_hd95 22.803509
2021-11-25 16:59:02,681 ============================================================
============================================================
2021-11-25 16:59:02,681 Subject 7 out of 11: case28
Subject 7 out of 11: case28
2021-11-25 16:59:05,910 case 6 mean_dice 0.641625 mean_hd95 17.029386
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 41478
GtSum: 35302
Predsum: 41478
GtSum: 35302
Predsum: 41478
GtSum: 35302
case 6 mean_dice 0.641625 mean_hd95 17.029386
2021-11-25 16:59:06,114 ============================================================
============================================================
2021-11-25 16:59:06,115 Subject 8 out of 11: case34
Subject 8 out of 11: case34
2021-11-25 16:59:10,137 case 7 mean_dice 0.576120 mean_hd95 26.076810
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 43663
GtSum: 22108
Predsum: 43663
GtSum: 22108
Predsum: 43663
GtSum: 22108
case 7 mean_dice 0.576120 mean_hd95 26.076810
2021-11-25 16:59:10,341 ============================================================
============================================================
2021-11-25 16:59:10,341 Subject 9 out of 11: case01
Subject 9 out of 11: case01
2021-11-25 16:59:14,571 case 8 mean_dice 0.690662 mean_hd95 11.575837
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 40953
GtSum: 32785
Predsum: 40953
GtSum: 32785
Predsum: 40953
GtSum: 32785
case 8 mean_dice 0.690662 mean_hd95 11.575837
2021-11-25 16:59:14,777 ============================================================
============================================================
2021-11-25 16:59:14,777 Subject 10 out of 11: case27
Subject 10 out of 11: case27
2021-11-25 16:59:17,832 case 9 mean_dice 0.554566 mean_hd95 25.709920
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 41833
GtSum: 28312
Predsum: 41833
GtSum: 28312
Predsum: 41833
GtSum: 28312
case 9 mean_dice 0.554566 mean_hd95 25.709920
2021-11-25 16:59:18,036 ============================================================
============================================================
2021-11-25 16:59:18,036 Subject 11 out of 11: case31
Subject 11 out of 11: case31
2021-11-25 16:59:21,091 case 10 mean_dice 0.660664 mean_hd95 23.600847
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 48601
GtSum: 38802
Predsum: 48601
GtSum: 38802
Predsum: 48601
GtSum: 38802
case 10 mean_dice 0.660664 mean_hd95 23.600847
2021-11-25 16:59:21,092 Mean class 0 mean_dice 0.621390 mean_hd95 22.869810
Mean class 0 mean_dice 0.621390 mean_hd95 22.869810
2021-11-25 16:59:21,092 Mean class 1 mean_dice 0.621390 mean_hd95 22.869810
Mean class 1 mean_dice 0.621390 mean_hd95 22.869810
2021-11-25 16:59:21,092 Mean class 2 mean_dice 0.621390 mean_hd95 22.869810
Mean class 2 mean_dice 0.621390 mean_hd95 22.869810
2021-11-25 16:59:21,092 Testing performance in best val model: mean_dice : 0.621390 mean_hd95 : 22.869810
Testing performance in best val model: mean_dice : 0.621390 mean_hd95 : 22.869810
test.py successfully executed
