2021-12-03 16:06:03,619 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='UCL', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='UCL', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='UCL', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='UCL', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-12-03 16:06:03,620 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-12-03 16:06:03,637 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-12-03 16:06:21,650 ============================================================
============================================================
2021-12-03 16:06:21,650 Subject 1 out of 11: case29
Subject 1 out of 11: case29
2021-12-03 16:06:24,858 case 0 mean_dice 0.783514 mean_hd95 7.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 49342
GtSum: 50526
Predsum: 49342
GtSum: 50526
Predsum: 49342
GtSum: 50526
case 0 mean_dice 0.783514 mean_hd95 7.000000
2021-12-03 16:06:25,065 ============================================================
============================================================
2021-12-03 16:06:25,065 Subject 2 out of 11: case33
Subject 2 out of 11: case33
2021-12-03 16:06:28,167 case 1 mean_dice 0.821719 mean_hd95 4.123106
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 28252
GtSum: 27974
Predsum: 28252
GtSum: 27974
Predsum: 28252
GtSum: 27974
case 1 mean_dice 0.821719 mean_hd95 4.123106
2021-12-03 16:06:28,345 ============================================================
============================================================
2021-12-03 16:06:28,345 Subject 3 out of 11: case26
Subject 3 out of 11: case26
2021-12-03 16:06:31,452 case 2 mean_dice 0.826047 mean_hd95 20.591260
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 40477
GtSum: 41390
Predsum: 40477
GtSum: 41390
Predsum: 40477
GtSum: 41390
case 2 mean_dice 0.826047 mean_hd95 20.591260
2021-12-03 16:06:31,631 ============================================================
============================================================
2021-12-03 16:06:31,631 Subject 4 out of 11: case32
Subject 4 out of 11: case32
2021-12-03 16:06:34,712 case 3 mean_dice 0.614093 mean_hd95 34.871192
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 32099
GtSum: 20919
Predsum: 32099
GtSum: 20919
Predsum: 32099
GtSum: 20919
case 3 mean_dice 0.614093 mean_hd95 34.871192
2021-12-03 16:06:34,890 ============================================================
============================================================
2021-12-03 16:06:34,890 Subject 5 out of 11: case35
Subject 5 out of 11: case35
2021-12-03 16:06:37,972 case 4 mean_dice 0.840201 mean_hd95 3.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 30096
GtSum: 24679
Predsum: 30096
GtSum: 24679
Predsum: 30096
GtSum: 24679
case 4 mean_dice 0.840201 mean_hd95 3.000000
2021-12-03 16:06:38,148 ============================================================
============================================================
2021-12-03 16:06:38,148 Subject 6 out of 11: case30
Subject 6 out of 11: case30
2021-12-03 16:06:41,273 case 5 mean_dice 0.767648 mean_hd95 12.649111
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 40965
GtSum: 34752
Predsum: 40965
GtSum: 34752
Predsum: 40965
GtSum: 34752
case 5 mean_dice 0.767648 mean_hd95 12.649111
2021-12-03 16:06:41,453 ============================================================
============================================================
2021-12-03 16:06:41,453 Subject 7 out of 11: case28
Subject 7 out of 11: case28
2021-12-03 16:06:44,558 case 6 mean_dice 0.793344 mean_hd95 16.278821
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 45949
GtSum: 35302
Predsum: 45949
GtSum: 35302
Predsum: 45949
GtSum: 35302
case 6 mean_dice 0.793344 mean_hd95 16.278821
2021-12-03 16:06:44,736 ============================================================
============================================================
2021-12-03 16:06:44,736 Subject 8 out of 11: case34
Subject 8 out of 11: case34
2021-12-03 16:06:48,426 case 7 mean_dice 0.762508 mean_hd95 9.899495
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 35675
GtSum: 22108
Predsum: 35675
GtSum: 22108
Predsum: 35675
GtSum: 22108
case 7 mean_dice 0.762508 mean_hd95 9.899495
2021-12-03 16:06:48,605 ============================================================
============================================================
2021-12-03 16:06:48,605 Subject 9 out of 11: case01
Subject 9 out of 11: case01
2021-12-03 16:06:52,628 case 8 mean_dice 0.779675 mean_hd95 34.249088
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 40997
GtSum: 32785
Predsum: 40997
GtSum: 32785
Predsum: 40997
GtSum: 32785
case 8 mean_dice 0.779675 mean_hd95 34.249088
2021-12-03 16:06:52,805 ============================================================
============================================================
2021-12-03 16:06:52,805 Subject 10 out of 11: case27
Subject 10 out of 11: case27
2021-12-03 16:06:55,755 case 9 mean_dice 0.783578 mean_hd95 39.370039
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 24520
GtSum: 28312
Predsum: 24520
GtSum: 28312
Predsum: 24520
GtSum: 28312
case 9 mean_dice 0.783578 mean_hd95 39.370039
2021-12-03 16:06:55,931 ============================================================
============================================================
2021-12-03 16:06:55,932 Subject 11 out of 11: case31
Subject 11 out of 11: case31
2021-12-03 16:06:58,889 case 10 mean_dice 0.795223 mean_hd95 25.317978
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 49953
GtSum: 38802
Predsum: 49953
GtSum: 38802
Predsum: 49953
GtSum: 38802
case 10 mean_dice 0.795223 mean_hd95 25.317978
2021-12-03 16:06:58,889 Mean class 0 mean_dice 0.778868 mean_hd95 18.850008
Mean class 0 mean_dice 0.778868 mean_hd95 18.850008
2021-12-03 16:06:58,889 Mean class 1 mean_dice 0.778868 mean_hd95 18.850008
Mean class 1 mean_dice 0.778868 mean_hd95 18.850008
2021-12-03 16:06:58,890 Mean class 2 mean_dice 0.778868 mean_hd95 18.850008
Mean class 2 mean_dice 0.778868 mean_hd95 18.850008
2021-12-03 16:06:58,890 Testing performance in best val model: mean_dice : 0.778868 mean_hd95 : 18.850008
Testing performance in best val model: mean_dice : 0.778868 mean_hd95 : 18.850008
test.py successfully executed
