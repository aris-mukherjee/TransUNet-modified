2021-12-03 16:02:42,581 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='UCL', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='UCL', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='UCL', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='UCL', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-12-03 16:02:42,581 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-12-03 16:02:42,596 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-12-03 16:03:00,518 ============================================================
============================================================
2021-12-03 16:03:00,518 Subject 1 out of 11: case29
Subject 1 out of 11: case29
2021-12-03 16:03:03,642 case 0 mean_dice 0.876511 mean_hd95 3.162278
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 44106
GtSum: 50526
Predsum: 44106
GtSum: 50526
Predsum: 44106
GtSum: 50526
case 0 mean_dice 0.876511 mean_hd95 3.162278
2021-12-03 16:03:03,847 ============================================================
============================================================
2021-12-03 16:03:03,847 Subject 2 out of 11: case33
Subject 2 out of 11: case33
2021-12-03 16:03:06,760 case 1 mean_dice 0.800323 mean_hd95 4.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 26514
GtSum: 27974
Predsum: 26514
GtSum: 27974
Predsum: 26514
GtSum: 27974
case 1 mean_dice 0.800323 mean_hd95 4.000000
2021-12-03 16:03:06,944 ============================================================
============================================================
2021-12-03 16:03:06,945 Subject 3 out of 11: case26
Subject 3 out of 11: case26
2021-12-03 16:03:09,969 case 2 mean_dice 0.893156 mean_hd95 2.236068
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 35994
GtSum: 41390
Predsum: 35994
GtSum: 41390
Predsum: 35994
GtSum: 41390
case 2 mean_dice 0.893156 mean_hd95 2.236068
2021-12-03 16:03:10,148 ============================================================
============================================================
2021-12-03 16:03:10,149 Subject 4 out of 11: case32
Subject 4 out of 11: case32
2021-12-03 16:03:13,146 case 3 mean_dice 0.754016 mean_hd95 29.849623
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 23409
GtSum: 20919
Predsum: 23409
GtSum: 20919
Predsum: 23409
GtSum: 20919
case 3 mean_dice 0.754016 mean_hd95 29.849623
2021-12-03 16:03:13,324 ============================================================
============================================================
2021-12-03 16:03:13,324 Subject 5 out of 11: case35
Subject 5 out of 11: case35
2021-12-03 16:03:16,272 case 4 mean_dice 0.889059 mean_hd95 2.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 21021
GtSum: 24679
Predsum: 21021
GtSum: 24679
Predsum: 21021
GtSum: 24679
case 4 mean_dice 0.889059 mean_hd95 2.000000
2021-12-03 16:03:16,450 ============================================================
============================================================
2021-12-03 16:03:16,450 Subject 6 out of 11: case30
Subject 6 out of 11: case30
2021-12-03 16:03:19,465 case 5 mean_dice 0.823115 mean_hd95 4.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 31336
GtSum: 34752
Predsum: 31336
GtSum: 34752
Predsum: 31336
GtSum: 34752
case 5 mean_dice 0.823115 mean_hd95 4.000000
2021-12-03 16:03:19,642 ============================================================
============================================================
2021-12-03 16:03:19,642 Subject 7 out of 11: case28
Subject 7 out of 11: case28
2021-12-03 16:03:22,666 case 6 mean_dice 0.863983 mean_hd95 3.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 33410
GtSum: 35302
Predsum: 33410
GtSum: 35302
Predsum: 33410
GtSum: 35302
case 6 mean_dice 0.863983 mean_hd95 3.000000
2021-12-03 16:03:22,844 ============================================================
============================================================
2021-12-03 16:03:22,844 Subject 8 out of 11: case34
Subject 8 out of 11: case34
2021-12-03 16:03:26,510 case 7 mean_dice 0.881174 mean_hd95 2.236068
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 25794
GtSum: 22108
Predsum: 25794
GtSum: 22108
Predsum: 25794
GtSum: 22108
case 7 mean_dice 0.881174 mean_hd95 2.236068
2021-12-03 16:03:26,689 ============================================================
============================================================
2021-12-03 16:03:26,689 Subject 9 out of 11: case01
Subject 9 out of 11: case01
2021-12-03 16:03:30,670 case 8 mean_dice 0.884016 mean_hd95 2.828427
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 30508
GtSum: 32785
Predsum: 30508
GtSum: 32785
Predsum: 30508
GtSum: 32785
case 8 mean_dice 0.884016 mean_hd95 2.828427
2021-12-03 16:03:30,848 ============================================================
============================================================
2021-12-03 16:03:30,848 Subject 10 out of 11: case27
Subject 10 out of 11: case27
2021-12-03 16:03:33,730 case 9 mean_dice 0.838920 mean_hd95 3.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 22346
GtSum: 28312
Predsum: 22346
GtSum: 28312
Predsum: 22346
GtSum: 28312
case 9 mean_dice 0.838920 mean_hd95 3.000000
2021-12-03 16:03:33,909 ============================================================
============================================================
2021-12-03 16:03:33,910 Subject 11 out of 11: case31
Subject 11 out of 11: case31
2021-12-03 16:03:36,723 case 10 mean_dice 0.900437 mean_hd95 2.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 41057
GtSum: 38802
Predsum: 41057
GtSum: 38802
Predsum: 41057
GtSum: 38802
case 10 mean_dice 0.900437 mean_hd95 2.000000
2021-12-03 16:03:36,723 Mean class 0 mean_dice 0.854974 mean_hd95 5.301133
Mean class 0 mean_dice 0.854974 mean_hd95 5.301133
2021-12-03 16:03:36,723 Mean class 1 mean_dice 0.854974 mean_hd95 5.301133
Mean class 1 mean_dice 0.854974 mean_hd95 5.301133
2021-12-03 16:03:36,723 Mean class 2 mean_dice 0.854974 mean_hd95 5.301133
Mean class 2 mean_dice 0.854974 mean_hd95 5.301133
2021-12-03 16:03:36,723 Testing performance in best val model: mean_dice : 0.854974 mean_hd95 : 5.301133
Testing performance in best val model: mean_dice : 0.854974 mean_hd95 : 5.301133
test.py successfully executed
