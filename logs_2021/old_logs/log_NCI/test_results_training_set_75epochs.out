2021-11-22 13:54:33,279 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=1276, max_epochs=75, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=1276, max_epochs=75, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-22 13:54:33,280 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-22 13:54:33,305 Reading NCI - RUNMC images...
Reading NCI - RUNMC images...
2021-11-22 13:54:33,306 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-22 13:54:33,310 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-22 13:54:34,319 ============================================================
============================================================
2021-11-22 13:54:34,319 Subject 1 out of 15
Subject 1 out of 15
2021-11-22 13:54:38,541 case 0 mean_dice 0.918702 mean_hd95 1.138071
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1518383
GtSum: 1522670
Predsum: 15940
GtSum: 15007
Predsum: 38541
GtSum: 35187
case 0 mean_dice 0.918702 mean_hd95 1.138071
2021-11-22 13:54:38,562 ============================================================
============================================================
2021-11-22 13:54:38,562 Subject 2 out of 15
Subject 2 out of 15
2021-11-22 13:54:41,117 case 1 mean_dice 0.902197 mean_hd95 1.483163
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1257117
GtSum: 1262229
Predsum: 18434
GtSum: 14437
Predsum: 35169
GtSum: 34054
case 1 mean_dice 0.902197 mean_hd95 1.483163
2021-11-22 13:54:41,135 ============================================================
============================================================
2021-11-22 13:54:41,136 Subject 3 out of 15
Subject 3 out of 15
2021-11-22 13:54:43,727 case 2 mean_dice 0.897548 mean_hd95 1.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1262978
GtSum: 1269957
Predsum: 10665
GtSum: 8713
Predsum: 37077
GtSum: 32050
case 2 mean_dice 0.897548 mean_hd95 1.666667
2021-11-22 13:54:43,746 ============================================================
============================================================
2021-11-22 13:54:43,746 Subject 4 out of 15
Subject 4 out of 15
2021-11-22 13:54:45,611 case 3 mean_dice 0.873208 mean_hd95 1.759306
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 950240
GtSum: 953401
Predsum: 7353
GtSum: 5371
Predsum: 25447
GtSum: 24268
case 3 mean_dice 0.873208 mean_hd95 1.759306
2021-11-22 13:54:45,631 ============================================================
============================================================
2021-11-22 13:54:45,631 Subject 5 out of 15
Subject 5 out of 15
2021-11-22 13:54:48,229 case 4 mean_dice 0.897056 mean_hd95 1.609476
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1271889
GtSum: 1277059
Predsum: 21088
GtSum: 16651
Predsum: 17743
GtSum: 17010
case 4 mean_dice 0.897056 mean_hd95 1.609476
2021-11-22 13:54:48,248 ============================================================
============================================================
2021-11-22 13:54:48,248 Subject 6 out of 15
Subject 6 out of 15
2021-11-22 13:54:50,806 case 5 mean_dice 0.891093 mean_hd95 1.412023
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1271436
GtSum: 1275809
Predsum: 17811
GtSum: 13565
Predsum: 21473
GtSum: 21346
case 5 mean_dice 0.891093 mean_hd95 1.412023
2021-11-22 13:54:50,824 ============================================================
============================================================
2021-11-22 13:54:50,824 Subject 7 out of 15
Subject 7 out of 15
2021-11-22 13:54:52,698 case 6 mean_dice 0.898308 mean_hd95 14.091354
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 904957
GtSum: 911704
Predsum: 12979
GtSum: 12450
Predsum: 65104
GtSum: 58886
case 6 mean_dice 0.898308 mean_hd95 14.091354
2021-11-22 13:54:52,717 ============================================================
============================================================
2021-11-22 13:54:52,717 Subject 8 out of 15
Subject 8 out of 15
2021-11-22 13:54:55,308 case 7 mean_dice 0.914630 mean_hd95 1.520159
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1249022
GtSum: 1253304
Predsum: 16302
GtSum: 13051
Predsum: 45396
GtSum: 44365
case 7 mean_dice 0.914630 mean_hd95 1.520159
2021-11-22 13:54:55,328 ============================================================
============================================================
2021-11-22 13:54:55,328 Subject 9 out of 15
Subject 9 out of 15
2021-11-22 13:54:57,918 case 8 mean_dice 0.911605 mean_hd95 1.322706
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1253191
GtSum: 1258698
Predsum: 16713
GtSum: 13757
Predsum: 40816
GtSum: 38265
case 8 mean_dice 0.911605 mean_hd95 1.322706
2021-11-22 13:54:57,937 ============================================================
============================================================
2021-11-22 13:54:57,937 Subject 10 out of 15
Subject 10 out of 15
2021-11-22 13:55:00,502 case 9 mean_dice 0.870877 mean_hd95 1.673255
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1275199
GtSum: 1278929
Predsum: 6114
GtSum: 3718
Predsum: 29407
GtSum: 28073
case 9 mean_dice 0.870877 mean_hd95 1.673255
2021-11-22 13:55:00,521 ============================================================
============================================================
2021-11-22 13:55:00,521 Subject 11 out of 15
Subject 11 out of 15
2021-11-22 13:55:02,670 case 10 mean_dice 0.842757 mean_hd95 1.858830
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1022531
GtSum: 1029926
Predsum: 5345
GtSum: 3568
Predsum: 86236
GtSum: 80618
case 10 mean_dice 0.842757 mean_hd95 1.858830
2021-11-22 13:55:02,688 ============================================================
============================================================
2021-11-22 13:55:02,689 Subject 12 out of 15
Subject 12 out of 15
2021-11-22 13:55:05,246 case 11 mean_dice 0.867372 mean_hd95 1.333333
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1297244
GtSum: 1298791
Predsum: 6038
GtSum: 4635
Predsum: 7438
GtSum: 7294
case 11 mean_dice 0.867372 mean_hd95 1.333333
2021-11-22 13:55:05,265 ============================================================
============================================================
2021-11-22 13:55:05,265 Subject 13 out of 15
Subject 13 out of 15
2021-11-22 13:55:07,847 case 12 mean_dice 0.861598 mean_hd95 1.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1286229
GtSum: 1289689
Predsum: 13179
GtSum: 9047
Predsum: 11312
GtSum: 11984
case 12 mean_dice 0.861598 mean_hd95 1.666667
2021-11-22 13:55:07,866 ============================================================
============================================================
2021-11-22 13:55:07,866 Subject 14 out of 15
Subject 14 out of 15
2021-11-22 13:55:09,749 case 13 mean_dice 0.848363 mean_hd95 2.800161
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 947679
GtSum: 951880
Predsum: 5762
GtSum: 3442
Predsum: 29599
GtSum: 27718
case 13 mean_dice 0.848363 mean_hd95 2.800161
2021-11-22 13:55:09,764 ============================================================
============================================================
2021-11-22 13:55:09,764 Subject 15 out of 15
Subject 15 out of 15
2021-11-22 13:55:12,325 case 14 mean_dice 0.907777 mean_hd95 1.913886
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1273419
GtSum: 1278693
Predsum: 13920
GtSum: 10614
Predsum: 23381
GtSum: 21413
case 14 mean_dice 0.907777 mean_hd95 1.913886
2021-11-22 13:55:12,326 Mean class 0 mean_dice 0.997030 mean_hd95 0.066667
Mean class 0 mean_dice 0.997030 mean_hd95 0.066667
2021-11-22 13:55:12,326 Mean class 1 mean_dice 0.773398 mean_hd95 5.097261
Mean class 1 mean_dice 0.773398 mean_hd95 5.097261
2021-11-22 13:55:12,326 Mean class 2 mean_dice 0.890189 mean_hd95 2.285884
Mean class 2 mean_dice 0.890189 mean_hd95 2.285884
2021-11-22 13:55:12,326 Testing performance in best val model: mean_dice : 0.886873 mean_hd95 : 2.483270
Testing performance in best val model: mean_dice : 0.886873 mean_hd95 : 2.483270
test.py successfully executed
