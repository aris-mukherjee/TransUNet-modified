import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import statistics
from mlxtend.evaluate import permutation_test
import operator


fets_SD_unet_enhancing_tumor_da025 = [0.83653, 0.62650, 0.46053, 0.82161, 0.59003, 0.29152, 0.53480, 0.63457, 0.88818, 0.69681, 0.52548, 0.68059, 0.73843, 0.66860, 0.54736, 0.35524, 0.35464, 0.73880, 0.79877, 0.67471]
fets_TD1_unet_enhancing_tumor_da025 = [0.16495, 0.13709, 0.29340, 0.47678, 0.28618, 0.27288, 0.37057, 0.41851, 0.66111, 0.10835, 0.60234, 0.68880, 0.56666, 0.79626, 0.67043, 0.66993, 0.30790, 0.15770, 0.68445, 0.74354, 0.41656, 0.00087, 0.72629, 0.62815, 0.49364, 0.88789, 0.54936, 0.35661, 0.53908, 0.29341, 0.72173, 0.11170, 0.59207, 0.57395]
fets_TD2_unet_enhancing_tumor_da025 = [0.30908, 0.24720, 0.53400, 0.26345, 0.11884, 0.56980, 0.60523, 0.40633, 0.33283, 0.21937, 0.44419, 0.68907, 0.51919, 0.14572, 0.42509, 0.19911, 0.41356, 0.20382, 0.38591, 0.51065, 0.35797, 0.68171, 0.26493, 0.31474, 0.23626, 0.45986, 0.40374, 0.39124, 0.40939, 0.50984, 0.41869, 0.21011, 0.46858, 0.34881]

fets_SD_unet_whole_tumor_da025 = [0.87481, 0.70444, 0.53292, 0.87881, 0.68851, 0.40700, 0.79106, 0.69906, 0.85932, 0.66997, 0.58787, 0.76482, 0.90413, 0.78583, 0.88197, 0.40917, 0.20495, 0.57684, 0.80915, 0.63828]
fets_TD1_unet_whole_tumor_da025 = [0.43638, 0.49863, 0.18457, 0.76557, 0.28010, 0.12441, 0.64126, 0.55699, 0.62203, 0.24856, 0.44895, 0.40824, 0.50419, 0.55040, 0.64969, 0.70281, 0.26611, 0.17982, 0.49278, 0.74973]
fets_TD2_unet_whole_tumor_da025 = [0.60255, 0.55285, 0.69285, 0.54346, 0.56443, 0.86923, 0.63368, 0.56586, 0.68184, 0.25541, 0.55715, 0.47063, 0.53353, 0.26935, 0.49734, 0.09831, 0.45892, 0.20928, 0.82144, 0.69711]



fets_SD_unet_tumor_core_da025 = [0.81147, 0.60416, 0.51558, 0.81642, 0.58499, 0.28360, 0.49972, 0.77337, 0.78681, 0.86995, 0.74374, 0.75523, 0.60140, 0.69997, 0.42032, 0.23325, 0.36409, 0.78939, 0.81632, 0.77030]
fets_TD1_unet_tumor_core_da025 = [0.36582, 0.12699, 0.40664, 0.67457, 0.23766, 0.29309, 0.46874, 0.37472, 0.65660, 0.11993, 0.57906, 0.70736, 0.53384, 0.75713, 0.50894, 0.81381, 0.33459, 0.21652, 0.84353, 0.79950]
fets_TD2_unet_tumor_core_da025 = [0.33183, 0.24402, 0.69127, 0.45960, 0.19096, 0.81790, 0.61554, 0.63008, 0.32309, 0.36131, 0.48882, 0.67826, 0.50037, 0.22657, 0.68717, 0.17582, 0.39489, 0.35097, 0.40702, 0.67016]

fets_SD_unet_whole_tumor_da05 = [0.88038, 0.82477, 0.57200, 0.87592, 0.62998, 0.60999, 0.83740, 0.79148, 0.86576, 0.76304, 0.52992, 0.86770, 0.92621, 0.87582, 0.89500, 0.45920, 0.34485, 0.65676, 0.86856, 0.66630]
fets_TD1_unet_whole_tumor_da05 = [0.54748, 0.43127, 0.24627, 0.84614, 0.41209, 0.23724, 0.68111, 0.70022, 0.75857, 0.26087, 0.59294, 0.63671, 0.58579, 0.68859, 0.81646, 0.78274, 0.41968, 0.29069, 0.54272, 0.82344]
fets_TD2_unet_whole_tumor_da05 = [0.65191, 0.49782, 0.78360, 0.69029, 0.72215, 0.91828, 0.71748, 0.71973, 0.70031, 0.49002, 0.72035, 0.54167, 0.65270, 0.34130, 0.70214, 0.09252, 0.48692, 0.34246, 0.85000, 0.70992]

fets_SD_unet_enhancing_tumor_da05 = [0.82387, 0.72137, 0.61487, 0.81675, 0.35559, 0.39891, 0.64462, 0.72166, 0.86583, 0.76715, 0.46340, 0.76834, 0.78093, 0.78462, 0.60958, 0.49586, 0.59067, 0.73074, 0.83048, 0.68717]
fets_TD1_unet_enhancing_tumor_da05 = [0.44682, 0.08205, 0.40111, 0.64530, 0.42826, 0.37731, 0.47402, 0.73773, 0.69754, 0.10797, 0.72871, 0.74510, 0.61604, 0.76177, 0.75399, 0.70102, 0.44482, 0.33708, 0.75870, 0.72994]
fets_TD2_unet_enhancing_tumor_da05 = [0.48792, 0.32719, 0.61985, 0.48859, 0.47488, 0.64797, 0.70860, 0.58873, 0.45342, 0.43517, 0.65769, 0.69964, 0.72914, 0.32602, 0.65061, 0.09637, 0.42357, 0.42266, 0.48322, 0.59973] 

fets_SD_unet_tumor_core_da05 = [0.82908, 0.72177, 0.65164, 0.90147, 0.34051, 0.35393, 0.58284, 0.84422, 0.91797, 0.86102, 0.63358, 0.81199, 0.71419, 0.82028, 0.61928, 0.30882, 0.59303, 0.81963, 0.85340, 0.77715]
fets_TD1_unet_tumor_core_da05 = [0.49936, 0.05034, 0.42105, 0.73512, 0.42693, 0.37453, 0.51923, 0.75087, 0.81378, 0.09220, 0.71169, 0.81615, 0.55318, 0.84404, 0.70149, 0.73259, 0.47251, 0.33129, 0.91503, 0.76534]
fets_TD2_unet_tumor_core_da05 = [0.54006, 0.32324, 0.75392, 0.53352, 0.47043, 0.72223, 0.71071, 0.71700, 0.47247, 0.48786, 0.63450, 0.70737, 0.71534, 0.39680, 0.61008, 0.06039, 0.40806, 0.46231, 0.48751, 0.76680]


fets_SD_unwt_enhancing_tumor_da025 = [0.83291, 0.64192, 0.42246, 0.84916, 0.56146, 0.32923, 0.71851, 0.68576, 0.87303, 0.78339, 0.57977, 0.72563, 0.71875, 0.75972, 0.66986, 0.53981, 0.44668, 0.78737, 0.82729, 0.67613]
fets_TD1_unwt_enhancing_tumor_da025 = [0.20834, 0.23957, 0.18027, 0.59793, 0.14272, 0.05189, 0.28642, 0.82027, 0.79959, 0.15258, 0.69079, 0.66846, 0.55259, 0.82388, 0.68724, 0.67829, 0.23126, 0.11425, 0.83931, 0.78822]
fets_TD2_unwt_enhancing_tumor_da025 = [0.42989, 0.47707, 0.69629, 0.35984, 0.25395, 0.82403, 0.79858, 0.58107, 0.53065, 0.26441, 0.63051, 0.71390, 0.64813, 0.30800, 0.55839, 0.07476, 0.19848, 0.37088, 0.45974, 0.72779]

fets_SD_unwt_tumor_core_da025 = [0.76782, 0.66013, 0.49156, 0.83364, 0.52309, 0.29202, 0.62411, 0.81055, 0.80581, 0.91009, 0.80746, 0.76296, 0.65697, 0.76870, 0.56559, 0.31008, 0.45265, 0.83313, 0.81039, 0.77197]
fets_TD1_unwt_tumor_core_da025 = [0.25348, 0.20870, 0.21239, 0.71103, 0.10683, 0.04797, 0.38786, 0.79947, 0.80276, 0.13980, 0.71181, 0.68900, 0.52384, 0.78825, 0.60585, 0.80906, 0.22963, 0.13221, 0.89326, 0.81904]
fets_TD2_unwt_tumor_core_da025 = [0.37717, 0.46797, 0.74723, 0.42260, 0.24238, 0.82633, 0.79570, 0.68970, 0.53392, 0.29554, 0.68553, 0.73974, 0.65364, 0.34316, 0.72545, 0.06204, 0.18460, 0.40858, 0.40514, 0.76633]

fets_SD_unwt_whole_tumor_da05 = [0.86731, 0.59965, 0.51451, 0.81296, 0.61147, 0.36876, 0.82946, 0.61221, 0.79318, 0.71649, 0.58722, 0.82119, 0.87772, 0.78571, 0.84601, 0.43772, 0.16316, 0.50289, 0.78201, 0.59037]
fets_TD1_unwt_whole_tumor_da05 = [0.32313, 0.42888, 0.13151, 0.74485, 0.17918, 0.04498, 0.48352, 0.65444, 0.54747, 0.19587, 0.40503, 0.33615, 0.40723, 0.42130, 0.56633, 0.59071, 0.24157, 0.14381, 0.42174, 0.69715]
fets_TD2_unwt_whole_tumor_da05 = [0.61597, 0.56794, 0.68941, 0.59161, 0.52232, 0.87657, 0.58489, 0.57241, 0.77271, 0.29612, 0.66820, 0.42112, 0.47448, 0.24509, 0.56326, 0.06676, 0.22912, 0.24144, 0.85043, 0.62877]

fets_SD_unwt_enhancing_tumor_da05 = [0.81559, 0.53100, 0.24031, 0.79422, 0.58483, 0.17675, 0.70855, 0.60949, 0.86429, 0.75814, 0.52954, 0.68255, 0.70812, 0.73488, 0.44973, 0.44992, 0.23274, 0.69334, 0.75597, 0.69078]
fets_TD1_unwt_enhancing_tumor_da05 = [0.22701, 0.19631, 0.16278, 0.51499, 0.12809, 0.08993, 0.26184, 0.78465, 0.72475, 0.14196, 0.59940, 0.62543, 0.46141, 0.71074, 0.61974, 0.69099, 0.22880, 0.10553, 0.73918, 0.74493]
fets_TD2_unwt_enhancing_tumor_da05 = [0.47678, 0.60276, 0.64565, 0.46636, 0.19864, 0.72917, 0.75020, 0.58990, 0.53563, 0.24890, 0.69843, 0.70857, 0.66470, 0.22851, 0.63293, 0.08221, 0.14761, 0.32101, 0.47513, 0.55942]

fets_SD_unwt_tumor_core_da05 = [0.80339, 0.60018, 0.33535, 0.82615, 0.61889, 0.17352, 0.63097, 0.73523, 0.78302, 0.87001, 0.74506, 0.76682, 0.69681, 0.80180, 0.52099, 0.25836, 0.22819, 0.75398, 0.80146, 0.78740]
fets_TD1_unwt_tumor_core_da05 = [0.32374, 0.18656, 0.24404, 0.68111, 0.10493, 0.08186, 0.38464, 0.74033, 0.67988, 0.14752, 0.64415, 0.67814, 0.46316, 0.68978, 0.58701, 0.76893, 0.23743, 0.11247, 0.85231, 0.78466]
fets_TD2_unwt_tumor_core_da05 = [0.40029, 0.61738, 0.77904, 0.58024, 0.24000, 0.86706, 0.73834, 0.73733, 0.48580, 0.34866, 0.75484, 0.75444, 0.66332, 0.27619, 0.75891, 0.06286, 0.16493, 0.40708, 0.46992, 0.64274]


significance_level = 0.05

diff_unet = list(map(operator.sub, fets_SD_unet_tumor_core_da025, fets_TD1_unet_tumor_core_da025))
diff_unwt = list(map(operator.sub, fets_SD_unwt_tumor_core_da025, fets_TD1_unwt_tumor_core_da025))


def paired_two_sample_test():
    p_value = permutation_test(diff_unet, diff_unwt, paired=True, method="approximate", seed=0, num_rounds=100000)
    significant = p_value < significance_level
    print(f'The p-value in the Paired two-sided randomization test is {p_value}')
    if significant:
        print(f'Paired two-sided randomization test: The difference is statistically significant!')
    else:
        print("Paired two-sided randomization test: The difference is not statistically significant!")


if __name__ == "__main__":

    paired_two_sample_test()

    