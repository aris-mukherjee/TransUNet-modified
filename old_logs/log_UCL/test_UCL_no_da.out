2021-11-26 19:42:55,323 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='UCL', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='UCL', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='UCL', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='UCL', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-26 19:42:55,323 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-26 19:42:55,327 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-26 19:43:13,299 ============================================================
============================================================
2021-11-26 19:43:13,300 Subject 1 out of 11: case29
Subject 1 out of 11: case29
2021-11-26 19:43:16,482 case 0 mean_dice 0.677984 mean_hd95 17.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 51739
GtSum: 50526
Predsum: 51739
GtSum: 50526
Predsum: 51739
GtSum: 50526
case 0 mean_dice 0.677984 mean_hd95 17.000000
2021-11-26 19:43:16,707 ============================================================
============================================================
2021-11-26 19:43:16,707 Subject 2 out of 11: case33
Subject 2 out of 11: case33
2021-11-26 19:43:19,175 case 1 mean_dice 0.557395 mean_hd95 21.189620
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 32475
GtSum: 27974
Predsum: 32475
GtSum: 27974
Predsum: 32475
GtSum: 27974
case 1 mean_dice 0.557395 mean_hd95 21.189620
2021-11-26 19:43:19,366 ============================================================
============================================================
2021-11-26 19:43:19,366 Subject 3 out of 11: case26
Subject 3 out of 11: case26
2021-11-26 19:43:21,876 case 2 mean_dice 0.652145 mean_hd95 63.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 43033
GtSum: 41390
Predsum: 43033
GtSum: 41390
Predsum: 43033
GtSum: 41390
case 2 mean_dice 0.652145 mean_hd95 63.000000
2021-11-26 19:43:22,070 ============================================================
============================================================
2021-11-26 19:43:22,070 Subject 4 out of 11: case32
Subject 4 out of 11: case32
2021-11-26 19:43:24,553 case 3 mean_dice 0.505619 mean_hd95 41.698321
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 37987
GtSum: 20919
Predsum: 37987
GtSum: 20919
Predsum: 37987
GtSum: 20919
case 3 mean_dice 0.505619 mean_hd95 41.698321
2021-11-26 19:43:24,746 ============================================================
============================================================
2021-11-26 19:43:24,746 Subject 5 out of 11: case35
Subject 5 out of 11: case35
2021-11-26 19:43:27,187 case 4 mean_dice 0.677859 mean_hd95 76.366875
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 33513
GtSum: 24679
Predsum: 33513
GtSum: 24679
Predsum: 33513
GtSum: 24679
case 4 mean_dice 0.677859 mean_hd95 76.366875
2021-11-26 19:43:27,378 ============================================================
============================================================
2021-11-26 19:43:27,378 Subject 6 out of 11: case30
Subject 6 out of 11: case30
2021-11-26 19:43:29,897 case 5 mean_dice 0.628441 mean_hd95 26.702060
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 55589
GtSum: 34752
Predsum: 55589
GtSum: 34752
Predsum: 55589
GtSum: 34752
case 5 mean_dice 0.628441 mean_hd95 26.702060
2021-11-26 19:43:30,090 ============================================================
============================================================
2021-11-26 19:43:30,090 Subject 7 out of 11: case28
Subject 7 out of 11: case28
2021-11-26 19:43:32,623 case 6 mean_dice 0.608811 mean_hd95 57.105166
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 51730
GtSum: 35302
Predsum: 51730
GtSum: 35302
Predsum: 51730
GtSum: 35302
case 6 mean_dice 0.608811 mean_hd95 57.105166
2021-11-26 19:43:32,818 ============================================================
============================================================
2021-11-26 19:43:32,818 Subject 8 out of 11: case34
Subject 8 out of 11: case34
2021-11-26 19:43:35,857 case 7 mean_dice 0.507393 mean_hd95 86.645253
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 50668
GtSum: 22108
Predsum: 50668
GtSum: 22108
Predsum: 50668
GtSum: 22108
case 7 mean_dice 0.507393 mean_hd95 86.645253
2021-11-26 19:43:36,049 ============================================================
============================================================
2021-11-26 19:43:36,049 Subject 9 out of 11: case01
Subject 9 out of 11: case01
2021-11-26 19:43:39,342 case 8 mean_dice 0.617273 mean_hd95 40.915767
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 44215
GtSum: 32785
Predsum: 44215
GtSum: 32785
Predsum: 44215
GtSum: 32785
case 8 mean_dice 0.617273 mean_hd95 40.915767
2021-11-26 19:43:39,535 ============================================================
============================================================
2021-11-26 19:43:39,535 Subject 10 out of 11: case27
Subject 10 out of 11: case27
2021-11-26 19:43:41,993 case 9 mean_dice 0.619333 mean_hd95 68.439754
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 38857
GtSum: 28312
Predsum: 38857
GtSum: 28312
Predsum: 38857
GtSum: 28312
case 9 mean_dice 0.619333 mean_hd95 68.439754
2021-11-26 19:43:42,187 ============================================================
============================================================
2021-11-26 19:43:42,187 Subject 11 out of 11: case31
Subject 11 out of 11: case31
2021-11-26 19:43:44,670 case 10 mean_dice 0.690168 mean_hd95 27.147744
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 49872
GtSum: 38802
Predsum: 49872
GtSum: 38802
Predsum: 49872
GtSum: 38802
case 10 mean_dice 0.690168 mean_hd95 27.147744
2021-11-26 19:43:44,670 Mean class 0 mean_dice 0.612947 mean_hd95 47.837324
Mean class 0 mean_dice 0.612947 mean_hd95 47.837324
2021-11-26 19:43:44,670 Mean class 1 mean_dice 0.612947 mean_hd95 47.837324
Mean class 1 mean_dice 0.612947 mean_hd95 47.837324
2021-11-26 19:43:44,670 Mean class 2 mean_dice 0.612947 mean_hd95 47.837324
Mean class 2 mean_dice 0.612947 mean_hd95 47.837324
2021-11-26 19:43:44,670 Testing performance in best val model: mean_dice : 0.612947 mean_hd95 : 47.837324
Testing performance in best val model: mean_dice : 0.612947 mean_hd95 : 47.837324
test.py successfully executed
