2021-11-23 00:48:19,608 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=2831, max_epochs=140, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=2831, max_epochs=140, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-23 00:48:19,609 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-23 00:48:19,644 Reading NCI - RUNMC images...
Reading NCI - RUNMC images...
2021-11-23 00:48:19,645 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-23 00:48:19,646 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-23 00:48:19,995 ============================================================
============================================================
2021-11-23 00:48:19,995 Subject 1 out of 5
Subject 1 out of 5
2021-11-23 00:48:22,446 case 0 mean_dice 0.954637 mean_hd95 26.675104
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1109768
GtSum: 1112319
Predsum: 8802
GtSum: 0
Predsum: 61078
GtSum: 67329
case 0 mean_dice 0.954637 mean_hd95 26.675104
2021-11-23 00:48:22,454 ============================================================
============================================================
2021-11-23 00:48:22,455 Subject 2 out of 5
Subject 2 out of 5
2021-11-23 00:48:25,322 case 1 mean_dice 0.808123 mean_hd95 4.333333
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1286005
GtSum: 1285443
Predsum: 13104
GtSum: 15427
Predsum: 11611
GtSum: 9850
case 1 mean_dice 0.808123 mean_hd95 4.333333
2021-11-23 00:48:25,329 ============================================================
============================================================
2021-11-23 00:48:25,329 Subject 3 out of 5
Subject 3 out of 5
2021-11-23 00:48:28,190 case 2 mean_dice 0.799132 mean_hd95 2.149830
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1271773
GtSum: 1268532
Predsum: 10361
GtSum: 9185
Predsum: 28586
GtSum: 33003
case 2 mean_dice 0.799132 mean_hd95 2.149830
2021-11-23 00:48:28,198 ============================================================
============================================================
2021-11-23 00:48:28,198 Subject 4 out of 5
Subject 4 out of 5
2021-11-23 00:48:31,016 case 3 mean_dice 0.798988 mean_hd95 2.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1290444
GtSum: 1293654
Predsum: 7696
GtSum: 8046
Predsum: 12580
GtSum: 9020
case 3 mean_dice 0.798988 mean_hd95 2.666667
2021-11-23 00:48:31,023 ============================================================
============================================================
2021-11-23 00:48:31,023 Subject 5 out of 5
Subject 5 out of 5
2021-11-23 00:48:33,942 case 4 mean_dice 0.682162 mean_hd95 8.948599
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1139904
GtSum: 1088166
Predsum: 3749
GtSum: 8291
Predsum: 167067
GtSum: 214263
case 4 mean_dice 0.682162 mean_hd95 8.948599
2021-11-23 00:48:33,942 Mean class 0 mean_dice 0.991312 mean_hd95 1.200000
Mean class 0 mean_dice 0.991312 mean_hd95 1.200000
2021-11-23 00:48:33,943 Mean class 1 mean_dice 0.635430 mean_hd95 5.169159
Mean class 1 mean_dice 0.635430 mean_hd95 5.169159
2021-11-23 00:48:33,943 Mean class 2 mean_dice 0.799083 mean_hd95 20.494960
Mean class 2 mean_dice 0.799083 mean_hd95 20.494960
2021-11-23 00:48:33,943 Testing performance in best val model: mean_dice : 0.808608 mean_hd95 : 8.954707
Testing performance in best val model: mean_dice : 0.808608 mean_hd95 : 8.954707
test.py successfully executed
