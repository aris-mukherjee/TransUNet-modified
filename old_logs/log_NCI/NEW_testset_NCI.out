/scratch_net/biwidl217_second/arismu/Master_Thesis_Codes/project_TransUNet/TransUNet/utils.py:890: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if mask_type is 'squares_jigsaw':
/scratch_net/biwidl217_second/arismu/Master_Thesis_Codes/project_TransUNet/TransUNet/utils.py:897: SyntaxWarning: "is" with a literal. Did you mean "=="?
  elif mask_type is 'squares_zeros':
2021-11-25 14:45:58,177 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-25 14:45:58,178 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-25 14:45:58,180 Reading RUNMC images...
Reading RUNMC images...
2021-11-25 14:45:58,180 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-25 14:45:58,181 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-25 14:45:59,043 ============================================================
============================================================
2021-11-25 14:45:59,043 Subject 1 out of 10: Prostate3T-01-0030
Subject 1 out of 10: Prostate3T-01-0030
2021-11-25 14:46:02,573 case 0 mean_dice 0.896503 mean_hd95 1.244017
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1284416
GtSum: 1283204
Predsum: 12661
GtSum: 15406
Predsum: 13643
GtSum: 12110
case 0 mean_dice 0.896503 mean_hd95 1.244017
2021-11-25 14:46:02,587 ============================================================
============================================================
2021-11-25 14:46:02,588 Subject 2 out of 10: Prostate3T-01-0024
Subject 2 out of 10: Prostate3T-01-0024
2021-11-25 14:46:05,483 case 1 mean_dice 0.761801 mean_hd95 9.119249
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1233568
GtSum: 1235053
Predsum: 10398
GtSum: 3706
Predsum: 66754
GtSum: 71961
case 1 mean_dice 0.761801 mean_hd95 9.119249
2021-11-25 14:46:05,496 ============================================================
============================================================
2021-11-25 14:46:05,496 Subject 3 out of 10: Prostate3T-01-0022
Subject 3 out of 10: Prostate3T-01-0022
2021-11-25 14:46:08,401 case 2 mean_dice 0.897750 mean_hd95 1.412023
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1270587
GtSum: 1274580
Predsum: 14371
GtSum: 12200
Predsum: 25762
GtSum: 23940
case 2 mean_dice 0.897750 mean_hd95 1.412023
2021-11-25 14:46:08,414 ============================================================
============================================================
2021-11-25 14:46:08,414 Subject 4 out of 10: Prostate3T-01-0029
Subject 4 out of 10: Prostate3T-01-0029
2021-11-25 14:46:11,336 case 3 mean_dice 0.879157 mean_hd95 1.816497
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1257897
GtSum: 1263950
Predsum: 14150
GtSum: 11009
Predsum: 38673
GtSum: 35761
case 3 mean_dice 0.879157 mean_hd95 1.816497
2021-11-25 14:46:11,348 ============================================================
============================================================
2021-11-25 14:46:11,348 Subject 5 out of 10: Prostate3T-01-0025
Subject 5 out of 10: Prostate3T-01-0025
2021-11-25 14:46:13,920 case 4 mean_dice 0.825036 mean_hd95 1.992575
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1196563
GtSum: 1198472
Predsum: 9795
GtSum: 6443
Predsum: 38826
GtSum: 40269
case 4 mean_dice 0.825036 mean_hd95 1.992575
2021-11-25 14:46:13,933 ============================================================
============================================================
2021-11-25 14:46:13,933 Subject 6 out of 10: Prostate3T-01-0026
Subject 6 out of 10: Prostate3T-01-0026
2021-11-25 14:46:16,913 case 5 mean_dice 0.851287 mean_hd95 4.020753
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1235387
GtSum: 1244050
Predsum: 12932
GtSum: 9368
Predsum: 62401
GtSum: 57302
case 5 mean_dice 0.851287 mean_hd95 4.020753
2021-11-25 14:46:16,926 ============================================================
============================================================
2021-11-25 14:46:16,926 Subject 7 out of 10: Prostate3T-01-0023
Subject 7 out of 10: Prostate3T-01-0023
2021-11-25 14:46:19,799 case 6 mean_dice 0.895296 mean_hd95 1.412023
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1260873
GtSum: 1258654
Predsum: 11250
GtSum: 9905
Predsum: 38597
GtSum: 42161
case 6 mean_dice 0.895296 mean_hd95 1.412023
2021-11-25 14:46:19,813 ============================================================
============================================================
2021-11-25 14:46:19,813 Subject 8 out of 10: Prostate3T-01-0028
Subject 8 out of 10: Prostate3T-01-0028
2021-11-25 14:46:21,833 case 7 mean_dice 0.888239 mean_hd95 2.366340
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 922245
GtSum: 920520
Predsum: 12018
GtSum: 14719
Predsum: 48777
GtSum: 47801
case 7 mean_dice 0.888239 mean_hd95 2.366340
2021-11-25 14:46:21,846 ============================================================
============================================================
2021-11-25 14:46:21,846 Subject 9 out of 10: Prostate3T-01-0021
Subject 9 out of 10: Prostate3T-01-0021
2021-11-25 14:46:24,659 case 8 mean_dice 0.867097 mean_hd95 2.333333
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1243279
GtSum: 1243742
Predsum: 13938
GtSum: 10315
Predsum: 53503
GtSum: 56663
case 8 mean_dice 0.867097 mean_hd95 2.333333
2021-11-25 14:46:24,672 ============================================================
============================================================
2021-11-25 14:46:24,672 Subject 10 out of 10: Prostate3T-01-0027
Subject 10 out of 10: Prostate3T-01-0027
2021-11-25 14:46:27,544 case 9 mean_dice 0.902259 mean_hd95 1.561853
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1257574
GtSum: 1257124
Predsum: 16464
GtSum: 18231
Predsum: 36682
GtSum: 35365
case 9 mean_dice 0.902259 mean_hd95 1.561853
2021-11-25 14:46:27,544 Mean class 0 mean_dice 0.996273 mean_hd95 0.200000
Mean class 0 mean_dice 0.996273 mean_hd95 0.200000
2021-11-25 14:46:27,544 Mean class 1 mean_dice 0.710315 mean_hd95 5.715043
Mean class 1 mean_dice 0.710315 mean_hd95 5.715043
2021-11-25 14:46:27,545 Mean class 2 mean_dice 0.892740 mean_hd95 2.268556
Mean class 2 mean_dice 0.892740 mean_hd95 2.268556
2021-11-25 14:46:27,545 Testing performance in best val model: mean_dice : 0.866442 mean_hd95 : 2.727866
Testing performance in best val model: mean_dice : 0.866442 mean_hd95 : 2.727866
test.py successfully executed
