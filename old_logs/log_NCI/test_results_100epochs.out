2021-11-22 16:17:54,799 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=1701, max_epochs=100, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=1701, max_epochs=100, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-22 16:17:54,800 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-22 16:17:54,834 Reading RUNMC images...
Reading RUNMC images...
2021-11-22 16:17:54,834 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-22 16:17:54,837 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-22 16:17:55,714 ============================================================
============================================================
2021-11-22 16:17:55,714 Subject 1 out of 10: Prostate3T-01-0030
Subject 1 out of 10: Prostate3T-01-0030
2021-11-22 16:17:59,078 case 0 mean_dice 0.852941 mean_hd95 2.950871
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1282532
GtSum: 1283204
Predsum: 12216
GtSum: 15406
Predsum: 15972
GtSum: 12110
case 0 mean_dice 0.852941 mean_hd95 2.950871
2021-11-22 16:17:59,094 ============================================================
============================================================
2021-11-22 16:17:59,094 Subject 2 out of 10: Prostate3T-01-0024
Subject 2 out of 10: Prostate3T-01-0024
2021-11-22 16:18:01,754 case 1 mean_dice 0.744713 mean_hd95 10.191463
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1229158
GtSum: 1235053
Predsum: 11977
GtSum: 3706
Predsum: 69585
GtSum: 71961
case 1 mean_dice 0.744713 mean_hd95 10.191463
2021-11-22 16:18:01,769 ============================================================
============================================================
2021-11-22 16:18:01,769 Subject 3 out of 10: Prostate3T-01-0022
Subject 3 out of 10: Prostate3T-01-0022
2021-11-22 16:18:04,430 case 2 mean_dice 0.883956 mean_hd95 1.688165
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1271092
GtSum: 1274580
Predsum: 12805
GtSum: 12200
Predsum: 26823
GtSum: 23940
case 2 mean_dice 0.883956 mean_hd95 1.688165
2021-11-22 16:18:04,444 ============================================================
============================================================
2021-11-22 16:18:04,445 Subject 4 out of 10: Prostate3T-01-0029
Subject 4 out of 10: Prostate3T-01-0029
2021-11-22 16:18:07,123 case 3 mean_dice 0.855301 mean_hd95 2.453058
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1256798
GtSum: 1263950
Predsum: 13506
GtSum: 11009
Predsum: 40416
GtSum: 35761
case 3 mean_dice 0.855301 mean_hd95 2.453058
2021-11-22 16:18:07,139 ============================================================
============================================================
2021-11-22 16:18:07,139 Subject 5 out of 10: Prostate3T-01-0025
Subject 5 out of 10: Prostate3T-01-0025
2021-11-22 16:18:09,582 case 4 mean_dice 0.810417 mean_hd95 2.800161
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1194380
GtSum: 1198472
Predsum: 12470
GtSum: 6443
Predsum: 38334
GtSum: 40269
case 4 mean_dice 0.810417 mean_hd95 2.800161
2021-11-22 16:18:09,597 ============================================================
============================================================
2021-11-22 16:18:09,597 Subject 6 out of 10: Prostate3T-01-0026
Subject 6 out of 10: Prostate3T-01-0026
2021-11-22 16:18:12,359 case 5 mean_dice 0.836903 mean_hd95 4.020753
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1232908
GtSum: 1244050
Predsum: 13557
GtSum: 9368
Predsum: 64255
GtSum: 57302
case 5 mean_dice 0.836903 mean_hd95 4.020753
2021-11-22 16:18:12,373 ============================================================
============================================================
2021-11-22 16:18:12,373 Subject 7 out of 10: Prostate3T-01-0023
Subject 7 out of 10: Prostate3T-01-0023
2021-11-22 16:18:15,110 case 6 mean_dice 0.847144 mean_hd95 1.772208
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1260807
GtSum: 1258654
Predsum: 11607
GtSum: 9905
Predsum: 38306
GtSum: 42161
case 6 mean_dice 0.847144 mean_hd95 1.772208
2021-11-22 16:18:15,125 ============================================================
============================================================
2021-11-22 16:18:15,125 Subject 8 out of 10: Prostate3T-01-0028
Subject 8 out of 10: Prostate3T-01-0028
2021-11-22 16:18:17,095 case 7 mean_dice 0.872647 mean_hd95 3.354086
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 921142
GtSum: 920520
Predsum: 12086
GtSum: 14719
Predsum: 49812
GtSum: 47801
case 7 mean_dice 0.872647 mean_hd95 3.354086
2021-11-22 16:18:17,110 ============================================================
============================================================
2021-11-22 16:18:17,110 Subject 9 out of 10: Prostate3T-01-0021
Subject 9 out of 10: Prostate3T-01-0021
2021-11-22 16:18:19,713 case 8 mean_dice 0.833605 mean_hd95 2.490712
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1243251
GtSum: 1243742
Predsum: 14835
GtSum: 10315
Predsum: 52634
GtSum: 56663
case 8 mean_dice 0.833605 mean_hd95 2.490712
2021-11-22 16:18:19,731 ============================================================
============================================================
2021-11-22 16:18:19,731 Subject 10 out of 10: Prostate3T-01-0027
Subject 10 out of 10: Prostate3T-01-0027
2021-11-22 16:18:22,356 case 9 mean_dice 0.871748 mean_hd95 2.483163
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1257479
GtSum: 1257124
Predsum: 16600
GtSum: 18231
Predsum: 36641
GtSum: 35365
case 9 mean_dice 0.871748 mean_hd95 2.483163
2021-11-22 16:18:22,356 Mean class 0 mean_dice 0.995533 mean_hd95 0.400000
Mean class 0 mean_dice 0.995533 mean_hd95 0.400000
2021-11-22 16:18:22,356 Mean class 1 mean_dice 0.655705 mean_hd95 7.029847
Mean class 1 mean_dice 0.655705 mean_hd95 7.029847
2021-11-22 16:18:22,356 Mean class 2 mean_dice 0.871574 mean_hd95 2.831545
Mean class 2 mean_dice 0.871574 mean_hd95 2.831545
2021-11-22 16:18:22,356 Testing performance in best val model: mean_dice : 0.840938 mean_hd95 : 3.420464
Testing performance in best val model: mean_dice : 0.840938 mean_hd95 : 3.420464
test.py successfully executed
