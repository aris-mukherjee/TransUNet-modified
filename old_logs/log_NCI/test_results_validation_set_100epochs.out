2021-11-22 16:18:30,900 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=1701, max_epochs=100, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=1701, max_epochs=100, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-22 16:18:30,900 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-22 16:18:30,933 Reading NCI - RUNMC images...
Reading NCI - RUNMC images...
2021-11-22 16:18:30,933 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-22 16:18:30,934 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-22 16:18:31,290 ============================================================
============================================================
2021-11-22 16:18:31,290 Subject 1 out of 5
Subject 1 out of 5
2021-11-22 16:18:33,560 case 0 mean_dice 0.966279 mean_hd95 1.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1109116
GtSum: 1112319
Predsum: 8024
GtSum: 0
Predsum: 62508
GtSum: 67329
case 0 mean_dice 0.966279 mean_hd95 1.000000
2021-11-22 16:18:33,569 ============================================================
============================================================
2021-11-22 16:18:33,569 Subject 2 out of 5
Subject 2 out of 5
2021-11-22 16:18:36,161 case 1 mean_dice 0.815256 mean_hd95 3.209268
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1285448
GtSum: 1285443
Predsum: 14233
GtSum: 15427
Predsum: 11039
GtSum: 9850
case 1 mean_dice 0.815256 mean_hd95 3.209268
2021-11-22 16:18:36,171 ============================================================
============================================================
2021-11-22 16:18:36,171 Subject 3 out of 5
Subject 3 out of 5
2021-11-22 16:18:38,779 case 2 mean_dice 0.859695 mean_hd95 1.720759
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1269070
GtSum: 1268532
Predsum: 9703
GtSum: 9185
Predsum: 31947
GtSum: 33003
case 2 mean_dice 0.859695 mean_hd95 1.720759
2021-11-22 16:18:38,789 ============================================================
============================================================
2021-11-22 16:18:38,789 Subject 4 out of 5
Subject 4 out of 5
2021-11-22 16:18:41,338 case 3 mean_dice 0.811166 mean_hd95 2.449070
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1291719
GtSum: 1293654
Predsum: 7461
GtSum: 8046
Predsum: 11540
GtSum: 9020
case 3 mean_dice 0.811166 mean_hd95 2.449070
2021-11-22 16:18:41,348 ============================================================
============================================================
2021-11-22 16:18:41,349 Subject 5 out of 5
Subject 5 out of 5
2021-11-22 16:18:43,981 case 4 mean_dice 0.739838 mean_hd95 5.595297
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1118179
GtSum: 1088166
Predsum: 6469
GtSum: 8291
Predsum: 186072
GtSum: 214263
case 4 mean_dice 0.739838 mean_hd95 5.595297
2021-11-22 16:18:43,981 Mean class 0 mean_dice 0.993987 mean_hd95 0.600000
Mean class 0 mean_dice 0.993987 mean_hd95 0.600000
2021-11-22 16:18:43,981 Mean class 1 mean_dice 0.686559 mean_hd95 4.438162
Mean class 1 mean_dice 0.686559 mean_hd95 4.438162
2021-11-22 16:18:43,981 Mean class 2 mean_dice 0.834794 mean_hd95 3.346475
Mean class 2 mean_dice 0.834794 mean_hd95 3.346475
2021-11-22 16:18:43,981 Testing performance in best val model: mean_dice : 0.838447 mean_hd95 : 2.794879
Testing performance in best val model: mean_dice : 0.838447 mean_hd95 : 2.794879
test.py successfully executed
