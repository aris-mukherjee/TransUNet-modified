2021-11-22 14:00:27,651 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=1276, max_epochs=75, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=1276, max_epochs=75, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-22 14:00:27,652 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-22 14:00:27,655 Reading NCI - RUNMC images...
Reading NCI - RUNMC images...
2021-11-22 14:00:27,655 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-22 14:00:27,659 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-22 14:00:28,015 ============================================================
============================================================
2021-11-22 14:00:28,015 Subject 1 out of 5
Subject 1 out of 5
2021-11-22 14:00:30,872 case 0 mean_dice 0.962008 mean_hd95 1.078689
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1111521
GtSum: 1112319
Predsum: 8222
GtSum: 0
Predsum: 59905
GtSum: 67329
case 0 mean_dice 0.962008 mean_hd95 1.078689
2021-11-22 14:00:30,882 ============================================================
============================================================
2021-11-22 14:00:30,882 Subject 2 out of 5
Subject 2 out of 5
2021-11-22 14:00:33,607 case 1 mean_dice 0.811098 mean_hd95 3.771236
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1283048
GtSum: 1285443
Predsum: 15396
GtSum: 15427
Predsum: 12276
GtSum: 9850
case 1 mean_dice 0.811098 mean_hd95 3.771236
2021-11-22 14:00:33,615 ============================================================
============================================================
2021-11-22 14:00:33,615 Subject 3 out of 5
Subject 3 out of 5
2021-11-22 14:00:36,341 case 2 mean_dice 0.847984 mean_hd95 2.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1265957
GtSum: 1268532
Predsum: 12727
GtSum: 9185
Predsum: 32036
GtSum: 33003
case 2 mean_dice 0.847984 mean_hd95 2.000000
2021-11-22 14:00:36,350 ============================================================
============================================================
2021-11-22 14:00:36,350 Subject 4 out of 5
Subject 4 out of 5
2021-11-22 14:00:39,017 case 3 mean_dice 0.807016 mean_hd95 2.401920
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1289897
GtSum: 1293654
Predsum: 9300
GtSum: 8046
Predsum: 11523
GtSum: 9020
case 3 mean_dice 0.807016 mean_hd95 2.401920
2021-11-22 14:00:39,025 ============================================================
============================================================
2021-11-22 14:00:39,025 Subject 5 out of 5
Subject 5 out of 5
2021-11-22 14:00:41,793 case 4 mean_dice 0.731990 mean_hd95 6.444507
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1115746
GtSum: 1088166
Predsum: 12563
GtSum: 8291
Predsum: 182411
GtSum: 214263
case 4 mean_dice 0.731990 mean_hd95 6.444507
2021-11-22 14:00:41,794 Mean class 0 mean_dice 0.993700 mean_hd95 0.546410
Mean class 0 mean_dice 0.993700 mean_hd95 0.546410
2021-11-22 14:00:41,794 Mean class 1 mean_dice 0.680654 mean_hd95 5.061643
Mean class 1 mean_dice 0.680654 mean_hd95 5.061643
2021-11-22 14:00:41,794 Mean class 2 mean_dice 0.821703 mean_hd95 3.809759
Mean class 2 mean_dice 0.821703 mean_hd95 3.809759
2021-11-22 14:00:41,794 Testing performance in best val model: mean_dice : 0.832019 mean_hd95 : 3.139270
Testing performance in best val model: mean_dice : 0.832019 mean_hd95 : 3.139270
test.py successfully executed
