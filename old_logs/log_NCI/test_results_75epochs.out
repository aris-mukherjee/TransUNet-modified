2021-11-22 13:46:04,119 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=1276, max_epochs=75, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=1276, max_epochs=75, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-22 13:46:04,120 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-22 13:46:04,141 Reading RUNMC images...
Reading RUNMC images...
2021-11-22 13:46:04,141 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-22 13:46:04,145 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-22 13:46:05,077 ============================================================
============================================================
2021-11-22 13:46:05,078 Subject 1 out of 10: Prostate3T-01-0030
Subject 1 out of 10: Prostate3T-01-0030
2021-11-22 13:46:08,443 case 0 mean_dice 0.855987 mean_hd95 4.778606
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1280391
GtSum: 1283204
Predsum: 14386
GtSum: 15406
Predsum: 15943
GtSum: 12110
case 0 mean_dice 0.855987 mean_hd95 4.778606
2021-11-22 13:46:08,458 ============================================================
============================================================
2021-11-22 13:46:08,458 Subject 2 out of 10: Prostate3T-01-0024
Subject 2 out of 10: Prostate3T-01-0024
2021-11-22 13:46:11,294 case 1 mean_dice 0.733607 mean_hd95 11.100648
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1223807
GtSum: 1235053
Predsum: 17216
GtSum: 3706
Predsum: 69697
GtSum: 71961
case 1 mean_dice 0.733607 mean_hd95 11.100648
2021-11-22 13:46:11,308 ============================================================
============================================================
2021-11-22 13:46:11,309 Subject 3 out of 10: Prostate3T-01-0022
Subject 3 out of 10: Prostate3T-01-0022
2021-11-22 13:46:13,970 case 2 mean_dice 0.874904 mean_hd95 1.759306
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1266813
GtSum: 1274580
Predsum: 16243
GtSum: 12200
Predsum: 27664
GtSum: 23940
case 2 mean_dice 0.874904 mean_hd95 1.759306
2021-11-22 13:46:13,984 ============================================================
============================================================
2021-11-22 13:46:13,984 Subject 4 out of 10: Prostate3T-01-0029
Subject 4 out of 10: Prostate3T-01-0029
2021-11-22 13:46:16,622 case 3 mean_dice 0.841174 mean_hd95 2.650511
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1253109
GtSum: 1263950
Predsum: 16786
GtSum: 11009
Predsum: 40825
GtSum: 35761
case 3 mean_dice 0.841174 mean_hd95 2.650511
2021-11-22 13:46:16,636 ============================================================
============================================================
2021-11-22 13:46:16,636 Subject 5 out of 10: Prostate3T-01-0025
Subject 5 out of 10: Prostate3T-01-0025
2021-11-22 13:46:19,040 case 4 mean_dice 0.782765 mean_hd95 3.173519
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1190068
GtSum: 1198472
Predsum: 15985
GtSum: 6443
Predsum: 39131
GtSum: 40269
case 4 mean_dice 0.782765 mean_hd95 3.173519
2021-11-22 13:46:19,053 ============================================================
============================================================
2021-11-22 13:46:19,053 Subject 6 out of 10: Prostate3T-01-0026
Subject 6 out of 10: Prostate3T-01-0026
2021-11-22 13:46:21,816 case 5 mean_dice 0.818730 mean_hd95 4.679844
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1228823
GtSum: 1244050
Predsum: 17868
GtSum: 9368
Predsum: 64029
GtSum: 57302
case 5 mean_dice 0.818730 mean_hd95 4.679844
2021-11-22 13:46:21,830 ============================================================
============================================================
2021-11-22 13:46:21,831 Subject 7 out of 10: Prostate3T-01-0023
Subject 7 out of 10: Prostate3T-01-0023
2021-11-22 13:46:24,517 case 6 mean_dice 0.834252 mean_hd95 2.690356
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1257214
GtSum: 1258654
Predsum: 15506
GtSum: 9905
Predsum: 38000
GtSum: 42161
case 6 mean_dice 0.834252 mean_hd95 2.690356
2021-11-22 13:46:24,531 ============================================================
============================================================
2021-11-22 13:46:24,531 Subject 8 out of 10: Prostate3T-01-0028
Subject 8 out of 10: Prostate3T-01-0028
2021-11-22 13:46:26,418 case 7 mean_dice 0.873321 mean_hd95 2.333333
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 920953
GtSum: 920520
Predsum: 13292
GtSum: 14719
Predsum: 48795
GtSum: 47801
case 7 mean_dice 0.873321 mean_hd95 2.333333
2021-11-22 13:46:26,431 ============================================================
============================================================
2021-11-22 13:46:26,431 Subject 9 out of 10: Prostate3T-01-0021
Subject 9 out of 10: Prostate3T-01-0021
2021-11-22 13:46:29,070 case 8 mean_dice 0.816500 mean_hd95 3.078689
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1239937
GtSum: 1243742
Predsum: 18293
GtSum: 10315
Predsum: 52490
GtSum: 56663
case 8 mean_dice 0.816500 mean_hd95 3.078689
2021-11-22 13:46:29,083 ============================================================
============================================================
2021-11-22 13:46:29,083 Subject 10 out of 10: Prostate3T-01-0027
Subject 10 out of 10: Prostate3T-01-0027
2021-11-22 13:46:31,738 case 9 mean_dice 0.860677 mean_hd95 2.119725
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1254395
GtSum: 1257124
Predsum: 18699
GtSum: 18231
Predsum: 37626
GtSum: 35365
case 9 mean_dice 0.860677 mean_hd95 2.119725
2021-11-22 13:46:31,738 Mean class 0 mean_dice 0.994820 mean_hd95 0.500000
Mean class 0 mean_dice 0.994820 mean_hd95 0.500000
2021-11-22 13:46:31,738 Mean class 1 mean_dice 0.633866 mean_hd95 7.486844
Mean class 1 mean_dice 0.633866 mean_hd95 7.486844
2021-11-22 13:46:31,738 Mean class 2 mean_dice 0.858889 mean_hd95 3.522517
Mean class 2 mean_dice 0.858889 mean_hd95 3.522517
2021-11-22 13:46:31,738 Testing performance in best val model: mean_dice : 0.829192 mean_hd95 : 3.836454
Testing performance in best val model: mean_dice : 0.829192 mean_hd95 : 3.836454
test.py successfully executed
