2021-11-23 00:47:28,665 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=2831, max_epochs=140, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=2831, max_epochs=140, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-23 00:47:28,665 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-23 00:47:28,705 Reading NCI - RUNMC images...
Reading NCI - RUNMC images...
2021-11-23 00:47:28,705 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-23 00:47:28,709 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-23 00:47:29,712 ============================================================
============================================================
2021-11-23 00:47:29,712 Subject 1 out of 15
Subject 1 out of 15
2021-11-23 00:47:34,166 case 0 mean_dice 0.951654 mean_hd95 0.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1519564
GtSum: 1522670
Predsum: 17486
GtSum: 15007
Predsum: 35814
GtSum: 35187
case 0 mean_dice 0.951654 mean_hd95 0.666667
2021-11-23 00:47:34,184 ============================================================
============================================================
2021-11-23 00:47:34,184 Subject 2 out of 15
Subject 2 out of 15
2021-11-23 00:47:36,967 case 1 mean_dice 0.949935 mean_hd95 0.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1259265
GtSum: 1262229
Predsum: 17029
GtSum: 14437
Predsum: 34426
GtSum: 34054
case 1 mean_dice 0.949935 mean_hd95 0.666667
2021-11-23 00:47:36,981 ============================================================
============================================================
2021-11-23 00:47:36,981 Subject 3 out of 15
Subject 3 out of 15
2021-11-23 00:47:39,851 case 2 mean_dice 0.947343 mean_hd95 0.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1266890
GtSum: 1269957
Predsum: 10321
GtSum: 8713
Predsum: 33509
GtSum: 32050
case 2 mean_dice 0.947343 mean_hd95 0.666667
2021-11-23 00:47:39,866 ============================================================
============================================================
2021-11-23 00:47:39,866 Subject 4 out of 15
Subject 4 out of 15
2021-11-23 00:47:41,844 case 3 mean_dice 0.932574 mean_hd95 0.804738
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 950597
GtSum: 953401
Predsum: 6814
GtSum: 5371
Predsum: 25629
GtSum: 24268
case 3 mean_dice 0.932574 mean_hd95 0.804738
2021-11-23 00:47:41,860 ============================================================
============================================================
2021-11-23 00:47:41,860 Subject 5 out of 15
Subject 5 out of 15
2021-11-23 00:47:44,754 case 4 mean_dice 0.943494 mean_hd95 0.804738
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1274075
GtSum: 1277059
Predsum: 20116
GtSum: 16651
Predsum: 16529
GtSum: 17010
case 4 mean_dice 0.943494 mean_hd95 0.804738
2021-11-23 00:47:44,772 ============================================================
============================================================
2021-11-23 00:47:44,772 Subject 6 out of 15
Subject 6 out of 15
2021-11-23 00:47:47,580 case 5 mean_dice 0.943448 mean_hd95 0.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1273294
GtSum: 1275809
Predsum: 16411
GtSum: 13565
Predsum: 21015
GtSum: 21346
case 5 mean_dice 0.943448 mean_hd95 0.666667
2021-11-23 00:47:47,595 ============================================================
============================================================
2021-11-23 00:47:47,595 Subject 7 out of 15
Subject 7 out of 15
2021-11-23 00:47:49,598 case 6 mean_dice 0.936949 mean_hd95 0.910684
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 906281
GtSum: 911704
Predsum: 15922
GtSum: 12450
Predsum: 60837
GtSum: 58886
case 6 mean_dice 0.936949 mean_hd95 0.910684
2021-11-23 00:47:49,618 ============================================================
============================================================
2021-11-23 00:47:49,618 Subject 8 out of 15
Subject 8 out of 15
2021-11-23 00:47:52,441 case 7 mean_dice 0.947133 mean_hd95 0.804738
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1249119
GtSum: 1253304
Predsum: 15353
GtSum: 13051
Predsum: 46248
GtSum: 44365
case 7 mean_dice 0.947133 mean_hd95 0.804738
2021-11-23 00:47:52,456 ============================================================
============================================================
2021-11-23 00:47:52,456 Subject 9 out of 15
Subject 9 out of 15
2021-11-23 00:47:55,301 case 8 mean_dice 0.945559 mean_hd95 0.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1255160
GtSum: 1258698
Predsum: 16027
GtSum: 13757
Predsum: 39533
GtSum: 38265
case 8 mean_dice 0.945559 mean_hd95 0.666667
2021-11-23 00:47:55,317 ============================================================
============================================================
2021-11-23 00:47:55,317 Subject 10 out of 15
Subject 10 out of 15
2021-11-23 00:47:58,144 case 9 mean_dice 0.918832 mean_hd95 0.804738
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1276612
GtSum: 1278929
Predsum: 5149
GtSum: 3718
Predsum: 28959
GtSum: 28073
case 9 mean_dice 0.918832 mean_hd95 0.804738
2021-11-23 00:47:58,162 ============================================================
============================================================
2021-11-23 00:47:58,162 Subject 11 out of 15
Subject 11 out of 15
2021-11-23 00:48:00,462 case 10 mean_dice 0.923995 mean_hd95 0.804738
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1024327
GtSum: 1029926
Predsum: 4235
GtSum: 3568
Predsum: 85550
GtSum: 80618
case 10 mean_dice 0.923995 mean_hd95 0.804738
2021-11-23 00:48:00,478 ============================================================
============================================================
2021-11-23 00:48:00,479 Subject 12 out of 15
Subject 12 out of 15
2021-11-23 00:48:03,330 case 11 mean_dice 0.913435 mean_hd95 0.804738
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1296252
GtSum: 1298791
Predsum: 5962
GtSum: 4635
Predsum: 8506
GtSum: 7294
case 11 mean_dice 0.913435 mean_hd95 0.804738
2021-11-23 00:48:03,345 ============================================================
============================================================
2021-11-23 00:48:03,346 Subject 13 out of 15
Subject 13 out of 15
2021-11-23 00:48:06,206 case 12 mean_dice 0.932947 mean_hd95 0.804738
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1287399
GtSum: 1289689
Predsum: 11116
GtSum: 9047
Predsum: 12205
GtSum: 11984
case 12 mean_dice 0.932947 mean_hd95 0.804738
2021-11-23 00:48:06,223 ============================================================
============================================================
2021-11-23 00:48:06,223 Subject 14 out of 15
Subject 14 out of 15
2021-11-23 00:48:08,215 case 13 mean_dice 0.924688 mean_hd95 0.804738
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 949065
GtSum: 951880
Predsum: 4709
GtSum: 3442
Predsum: 29266
GtSum: 27718
case 13 mean_dice 0.924688 mean_hd95 0.804738
2021-11-23 00:48:08,231 ============================================================
============================================================
2021-11-23 00:48:08,231 Subject 15 out of 15
Subject 15 out of 15
2021-11-23 00:48:11,100 case 14 mean_dice 0.953184 mean_hd95 0.666667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1276387
GtSum: 1278693
Predsum: 12406
GtSum: 10614
Predsum: 21927
GtSum: 21413
case 14 mean_dice 0.953184 mean_hd95 0.666667
2021-11-23 00:48:11,101 Mean class 0 mean_dice 0.998303 mean_hd95 0.000000
Mean class 0 mean_dice 0.998303 mean_hd95 0.000000
2021-11-23 00:48:11,101 Mean class 1 mean_dice 0.869681 mean_hd95 1.214489
Mean class 1 mean_dice 0.869681 mean_hd95 1.214489
2021-11-23 00:48:11,101 Mean class 2 mean_dice 0.945050 mean_hd95 1.055228
Mean class 2 mean_dice 0.945050 mean_hd95 1.055228
2021-11-23 00:48:11,101 Testing performance in best val model: mean_dice : 0.937678 mean_hd95 : 0.756572
Testing performance in best val model: mean_dice : 0.937678 mean_hd95 : 0.756572
test.py successfully executed
