2021-11-22 12:05:56,639 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=2381, max_epochs=140, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', dataset='RUNMC', num_classes=3, max_iterations=2381, max_epochs=140, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-22 12:05:56,639 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-22 12:05:56,641 Reading NCI - RUNMC images...
Reading NCI - RUNMC images...
2021-11-22 12:05:56,641 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-22 12:05:56,642 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-22 12:05:56,989 ============================================================
============================================================
2021-11-22 12:05:56,990 Subject 1 out of 5
Subject 1 out of 5
2021-11-22 12:05:59,813 case 0 mean_dice 0.965983 mean_hd95 1.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1108633
GtSum: 1112319
Predsum: 9206
GtSum: 0
Predsum: 61809
GtSum: 67329
case 0 mean_dice 0.965983 mean_hd95 1.000000
2021-11-22 12:05:59,822 ============================================================
============================================================
2021-11-22 12:05:59,822 Subject 2 out of 5
Subject 2 out of 5
2021-11-22 12:06:02,564 case 1 mean_dice 0.829392 mean_hd95 3.256655
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1285337
GtSum: 1285443
Predsum: 14852
GtSum: 15427
Predsum: 10531
GtSum: 9850
case 1 mean_dice 0.829392 mean_hd95 3.256655
2021-11-22 12:06:02,573 ============================================================
============================================================
2021-11-22 12:06:02,573 Subject 3 out of 5
Subject 3 out of 5
2021-11-22 12:06:05,291 case 2 mean_dice 0.866306 mean_hd95 1.720759
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1269391
GtSum: 1268532
Predsum: 10264
GtSum: 9185
Predsum: 31065
GtSum: 33003
case 2 mean_dice 0.866306 mean_hd95 1.720759
2021-11-22 12:06:05,300 ============================================================
============================================================
2021-11-22 12:06:05,300 Subject 4 out of 5
Subject 4 out of 5
2021-11-22 12:06:07,975 case 3 mean_dice 0.824746 mean_hd95 2.201850
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1291828
GtSum: 1293654
Predsum: 7897
GtSum: 8046
Predsum: 10995
GtSum: 9020
case 3 mean_dice 0.824746 mean_hd95 2.201850
2021-11-22 12:06:07,983 ============================================================
============================================================
2021-11-22 12:06:07,983 Subject 5 out of 5
Subject 5 out of 5
2021-11-22 12:06:10,743 case 4 mean_dice 0.782743 mean_hd95 4.672180
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1113076
GtSum: 1088166
Predsum: 11994
GtSum: 8291
Predsum: 185650
GtSum: 214263
case 4 mean_dice 0.782743 mean_hd95 4.672180
2021-11-22 12:06:10,743 Mean class 0 mean_dice 0.994505 mean_hd95 0.482843
Mean class 0 mean_dice 0.994505 mean_hd95 0.482843
2021-11-22 12:06:10,743 Mean class 1 mean_dice 0.725243 mean_hd95 3.674031
Mean class 1 mean_dice 0.725243 mean_hd95 3.674031
2021-11-22 12:06:10,743 Mean class 2 mean_dice 0.841754 mean_hd95 3.553993
Mean class 2 mean_dice 0.841754 mean_hd95 3.553993
2021-11-22 12:06:10,743 Testing performance in best val model: mean_dice : 0.853834 mean_hd95 : 2.570289
Testing performance in best val model: mean_dice : 0.853834 mean_hd95 : 2.570289
test.py successfully executed
