/scratch_net/biwidl217_second/arismu/Master_Thesis_Codes/project_TransUNet/TransUNet/utils.py:890: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if mask_type is 'squares_jigsaw':
/scratch_net/biwidl217_second/arismu/Master_Thesis_Codes/project_TransUNet/TransUNet/utils.py:897: SyntaxWarning: "is" with a literal. Did you mean "=="?
  elif mask_type is 'squares_zeros':
2021-11-22 10:47:53,884 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=2381, max_epochs=140, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=2381, max_epochs=140, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-22 10:47:53,884 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-22 10:47:53,886 Reading RUNMC images...
Reading RUNMC images...
2021-11-22 10:47:53,886 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-22 10:47:53,888 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-22 10:47:54,774 ============================================================
============================================================
2021-11-22 10:47:54,774 Subject 1 out of 10: Prostate3T-01-0030
Subject 1 out of 10: Prostate3T-01-0030
2021-11-22 10:47:57,625 case 0 mean_dice 0.874417 mean_hd95 1.799449
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1282887
GtSum: 1283204
Predsum: 13295
GtSum: 15406
Predsum: 14538
GtSum: 12110
case 0 mean_dice 0.874417 mean_hd95 1.799449
2021-11-22 10:47:57,644 ============================================================
============================================================
2021-11-22 10:47:57,644 Subject 2 out of 10: Prostate3T-01-0024
Subject 2 out of 10: Prostate3T-01-0024
2021-11-22 10:48:00,284 case 1 mean_dice 0.747652 mean_hd95 10.282882
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1229660
GtSum: 1235053
Predsum: 13418
GtSum: 3706
Predsum: 67642
GtSum: 71961
case 1 mean_dice 0.747652 mean_hd95 10.282882
2021-11-22 10:48:00,301 ============================================================
============================================================
2021-11-22 10:48:00,301 Subject 3 out of 10: Prostate3T-01-0022
Subject 3 out of 10: Prostate3T-01-0022
2021-11-22 10:48:02,935 case 2 mean_dice 0.889280 mean_hd95 1.561853
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1270754
GtSum: 1274580
Predsum: 13755
GtSum: 12200
Predsum: 26211
GtSum: 23940
case 2 mean_dice 0.889280 mean_hd95 1.561853
2021-11-22 10:48:02,952 ============================================================
============================================================
2021-11-22 10:48:02,952 Subject 4 out of 10: Prostate3T-01-0029
Subject 4 out of 10: Prostate3T-01-0029
2021-11-22 10:48:05,570 case 3 mean_dice 0.855180 mean_hd95 2.325908
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1256565
GtSum: 1263950
Predsum: 15060
GtSum: 11009
Predsum: 39095
GtSum: 35761
case 3 mean_dice 0.855180 mean_hd95 2.325908
2021-11-22 10:48:05,585 ============================================================
============================================================
2021-11-22 10:48:05,586 Subject 5 out of 10: Prostate3T-01-0025
Subject 5 out of 10: Prostate3T-01-0025
2021-11-22 10:48:07,946 case 4 mean_dice 0.805737 mean_hd95 2.879731
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1194202
GtSum: 1198472
Predsum: 13835
GtSum: 6443
Predsum: 37147
GtSum: 40269
case 4 mean_dice 0.805737 mean_hd95 2.879731
2021-11-22 10:48:07,962 ============================================================
============================================================
2021-11-22 10:48:07,962 Subject 6 out of 10: Prostate3T-01-0026
Subject 6 out of 10: Prostate3T-01-0026
2021-11-22 10:48:10,714 case 5 mean_dice 0.831750 mean_hd95 4.020753
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1232581
GtSum: 1244050
Predsum: 15394
GtSum: 9368
Predsum: 62745
GtSum: 57302
case 5 mean_dice 0.831750 mean_hd95 4.020753
2021-11-22 10:48:10,730 ============================================================
============================================================
2021-11-22 10:48:10,731 Subject 7 out of 10: Prostate3T-01-0023
Subject 7 out of 10: Prostate3T-01-0023
2021-11-22 10:48:13,349 case 6 mean_dice 0.853331 mean_hd95 1.868517
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1260928
GtSum: 1258654
Predsum: 12181
GtSum: 9905
Predsum: 37611
GtSum: 42161
case 6 mean_dice 0.853331 mean_hd95 1.868517
2021-11-22 10:48:13,365 ============================================================
============================================================
2021-11-22 10:48:13,365 Subject 8 out of 10: Prostate3T-01-0028
Subject 8 out of 10: Prostate3T-01-0028
2021-11-22 10:48:15,267 case 7 mean_dice 0.876047 mean_hd95 3.374679
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 921622
GtSum: 920520
Predsum: 12907
GtSum: 14719
Predsum: 48511
GtSum: 47801
case 7 mean_dice 0.876047 mean_hd95 3.374679
2021-11-22 10:48:15,283 ============================================================
============================================================
2021-11-22 10:48:15,283 Subject 9 out of 10: Prostate3T-01-0021
Subject 9 out of 10: Prostate3T-01-0021
2021-11-22 10:48:17,910 case 8 mean_dice 0.832387 mean_hd95 2.795055
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1242269
GtSum: 1243742
Predsum: 16861
GtSum: 10315
Predsum: 51590
GtSum: 56663
case 8 mean_dice 0.832387 mean_hd95 2.795055
2021-11-22 10:48:17,926 ============================================================
============================================================
2021-11-22 10:48:17,926 Subject 10 out of 10: Prostate3T-01-0027
Subject 10 out of 10: Prostate3T-01-0027
2021-11-22 10:48:20,552 case 9 mean_dice 0.877007 mean_hd95 2.149830
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 1256679
GtSum: 1257124
Predsum: 17931
GtSum: 18231
Predsum: 36110
GtSum: 35365
case 9 mean_dice 0.877007 mean_hd95 2.149830
2021-11-22 10:48:20,552 Mean class 0 mean_dice 0.995612 mean_hd95 0.400000
Mean class 0 mean_dice 0.995612 mean_hd95 0.400000
2021-11-22 10:48:20,553 Mean class 1 mean_dice 0.661196 mean_hd95 7.064258
Mean class 1 mean_dice 0.661196 mean_hd95 7.064258
2021-11-22 10:48:20,553 Mean class 2 mean_dice 0.876029 mean_hd95 2.453339
Mean class 2 mean_dice 0.876029 mean_hd95 2.453339
2021-11-22 10:48:20,553 Testing performance in best val model: mean_dice : 0.844279 mean_hd95 : 3.305866
Testing performance in best val model: mean_dice : 0.844279 mean_hd95 : 3.305866
test.py successfully executed
