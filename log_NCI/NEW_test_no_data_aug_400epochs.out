2021-11-25 18:47:16,033 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-11-25 18:47:16,034 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-11-25 18:47:16,077 Reading RUNMC images...
Reading RUNMC images...
2021-11-25 18:47:16,078 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-11-25 18:47:16,080 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-11-25 18:47:16,950 ============================================================
============================================================
2021-11-25 18:47:16,950 Subject 1 out of 10: Prostate3T-01-0030
Subject 1 out of 10: Prostate3T-01-0030
2021-11-25 18:47:20,271 case 0 mean_dice 0.862876 mean_hd95 7.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 28105
GtSum: 27516
Predsum: 28105
GtSum: 27516
Predsum: 28105
GtSum: 27516
case 0 mean_dice 0.862876 mean_hd95 7.000000
2021-11-25 18:47:20,285 ============================================================
============================================================
2021-11-25 18:47:20,285 Subject 2 out of 10: Prostate3T-01-0024
Subject 2 out of 10: Prostate3T-01-0024
2021-11-25 18:47:23,006 case 1 mean_dice 0.893835 mean_hd95 3.741657
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 88963
GtSum: 75667
Predsum: 88963
GtSum: 75667
Predsum: 88963
GtSum: 75667
case 1 mean_dice 0.893835 mean_hd95 3.741657
2021-11-25 18:47:23,022 ============================================================
============================================================
2021-11-25 18:47:23,022 Subject 3 out of 10: Prostate3T-01-0022
Subject 3 out of 10: Prostate3T-01-0022
2021-11-25 18:47:25,657 case 2 mean_dice 0.874701 mean_hd95 3.316625
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 42767
GtSum: 36140
Predsum: 42767
GtSum: 36140
Predsum: 42767
GtSum: 36140
case 2 mean_dice 0.874701 mean_hd95 3.316625
2021-11-25 18:47:25,669 ============================================================
============================================================
2021-11-25 18:47:25,669 Subject 4 out of 10: Prostate3T-01-0029
Subject 4 out of 10: Prostate3T-01-0029
2021-11-25 18:47:28,425 case 3 mean_dice 0.852026 mean_hd95 3.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 56032
GtSum: 46770
Predsum: 56032
GtSum: 46770
Predsum: 56032
GtSum: 46770
case 3 mean_dice 0.852026 mean_hd95 3.000000
2021-11-25 18:47:28,438 ============================================================
============================================================
2021-11-25 18:47:28,438 Subject 5 out of 10: Prostate3T-01-0025
Subject 5 out of 10: Prostate3T-01-0025
2021-11-25 18:47:30,843 case 4 mean_dice 0.872066 mean_hd95 6.708204
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 56232
GtSum: 46712
Predsum: 56232
GtSum: 46712
Predsum: 56232
GtSum: 46712
case 4 mean_dice 0.872066 mean_hd95 6.708204
2021-11-25 18:47:30,854 ============================================================
============================================================
2021-11-25 18:47:30,855 Subject 6 out of 10: Prostate3T-01-0026
Subject 6 out of 10: Prostate3T-01-0026
2021-11-25 18:47:33,744 case 5 mean_dice 0.859289 mean_hd95 4.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 82828
GtSum: 66670
Predsum: 82828
GtSum: 66670
Predsum: 82828
GtSum: 66670
case 5 mean_dice 0.859289 mean_hd95 4.000000
2021-11-25 18:47:33,755 ============================================================
============================================================
2021-11-25 18:47:33,755 Subject 7 out of 10: Prostate3T-01-0023
Subject 7 out of 10: Prostate3T-01-0023
2021-11-25 18:47:36,429 case 6 mean_dice 0.888956 mean_hd95 6.902048
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 54423
GtSum: 52066
Predsum: 54423
GtSum: 52066
Predsum: 54423
GtSum: 52066
case 6 mean_dice 0.888956 mean_hd95 6.902048
2021-11-25 18:47:36,441 ============================================================
============================================================
2021-11-25 18:47:36,441 Subject 8 out of 10: Prostate3T-01-0028
Subject 8 out of 10: Prostate3T-01-0028
2021-11-25 18:47:38,405 case 7 mean_dice 0.878854 mean_hd95 4.123106
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 67315
GtSum: 62520
Predsum: 67315
GtSum: 62520
Predsum: 67315
GtSum: 62520
case 7 mean_dice 0.878854 mean_hd95 4.123106
2021-11-25 18:47:38,416 ============================================================
============================================================
2021-11-25 18:47:38,416 Subject 9 out of 10: Prostate3T-01-0021
Subject 9 out of 10: Prostate3T-01-0021
2021-11-25 18:47:41,114 case 8 mean_dice 0.881756 mean_hd95 3.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 70001
GtSum: 66978
Predsum: 70001
GtSum: 66978
Predsum: 70001
GtSum: 66978
case 8 mean_dice 0.881756 mean_hd95 3.000000
2021-11-25 18:47:41,131 ============================================================
============================================================
2021-11-25 18:47:41,131 Subject 10 out of 10: Prostate3T-01-0027
Subject 10 out of 10: Prostate3T-01-0027
2021-11-25 18:47:43,790 case 9 mean_dice 0.888927 mean_hd95 3.741657
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 56494
GtSum: 53596
Predsum: 56494
GtSum: 53596
Predsum: 56494
GtSum: 53596
case 9 mean_dice 0.888927 mean_hd95 3.741657
2021-11-25 18:47:43,791 Mean class 0 mean_dice 0.875328 mean_hd95 4.553330
Mean class 0 mean_dice 0.875328 mean_hd95 4.553330
2021-11-25 18:47:43,791 Mean class 1 mean_dice 0.875328 mean_hd95 4.553330
Mean class 1 mean_dice 0.875328 mean_hd95 4.553330
2021-11-25 18:47:43,791 Mean class 2 mean_dice 0.875328 mean_hd95 4.553330
Mean class 2 mean_dice 0.875328 mean_hd95 4.553330
2021-11-25 18:47:43,791 Testing performance in best val model: mean_dice : 0.875328 mean_hd95 : 4.553330
Testing performance in best val model: mean_dice : 0.875328 mean_hd95 : 4.553330
test.py successfully executed
