2021-12-14 17:05:22,358 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='RUNMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='RUNMC', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-12-14 17:05:22,358 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-12-14 17:05:22,381 Reading RUNMC images...
Reading RUNMC images...
2021-12-14 17:05:22,381 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2021-12-14 17:05:22,382 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-12-14 17:05:23,417 ============================================================
============================================================
2021-12-14 17:05:23,417 Subject 1 out of 10: Prostate3T-01-0030
Subject 1 out of 10: Prostate3T-01-0030
2021-12-14 17:05:25,917 case 0 mean_dice 0.895662 mean_hd95 2.000000
Max: 0.9998766183853149
Max: 0.9998379945755005
Max: 0.9998239874839783
Max: 0.999811589717865
Max: 0.999839186668396
Max: 0.9998459815979004
Max: 0.9998160004615784
Max: 0.9998072981834412
Max: 0.9998934268951416
Max: 0.9999829530715942
Max: 0.9999833106994629
Max: 0.999956488609314
Max: 0.9999234676361084
Max: 0.9998781681060791
Max: 0.9998700618743896
Max: 0.9999101161956787
Max: 0.9999017715454102
Max: 0.9997850060462952
Max: 0.9998224377632141
Max: 0.9998979568481445
Predsum: 27996
GtSum: 27516
Predsum: 27996
GtSum: 27516
Predsum: 27996
GtSum: 27516
case 0 mean_dice 0.895662 mean_hd95 2.000000
2021-12-14 17:05:25,933 ============================================================
============================================================
2021-12-14 17:05:25,933 Subject 2 out of 10: Prostate3T-01-0024
Subject 2 out of 10: Prostate3T-01-0024
2021-12-14 17:05:28,334 case 1 mean_dice 0.928810 mean_hd95 2.236068
Max: 0.9998770952224731
Max: 0.9998664855957031
Max: 0.9998406171798706
Max: 0.999882698059082
Max: 0.9999018907546997
Max: 0.9999133348464966
Max: 0.9999047517776489
Max: 0.999916672706604
Max: 0.9999502897262573
Max: 0.999929666519165
Max: 0.9999228715896606
Max: 0.9998695850372314
Max: 0.9998435974121094
Max: 0.9998656511306763
Max: 0.9999083280563354
Max: 0.9998694658279419
Max: 0.9998711347579956
Max: 0.9998762607574463
Max: 0.9998846054077148
Max: 0.9999271631240845
Predsum: 79228
GtSum: 75667
Predsum: 79228
GtSum: 75667
Predsum: 79228
GtSum: 75667
case 1 mean_dice 0.928810 mean_hd95 2.236068
2021-12-14 17:05:28,350 ============================================================
============================================================
2021-12-14 17:05:28,350 Subject 3 out of 10: Prostate3T-01-0022
Subject 3 out of 10: Prostate3T-01-0022
2021-12-14 17:05:30,677 case 2 mean_dice 0.874550 mean_hd95 4.242641
Max: 0.9998217225074768
Max: 0.9998239874839783
Max: 0.999854326248169
Max: 0.9998880624771118
Max: 0.999817430973053
Max: 0.9998542070388794
Max: 0.9998213648796082
Max: 0.9998807907104492
Max: 0.9999701976776123
Max: 0.9999696016311646
Max: 0.9999607801437378
Max: 0.9999310970306396
Max: 0.999894380569458
Max: 0.9998847246170044
Max: 0.9998321533203125
Max: 0.9997715353965759
Max: 0.9998875856399536
Max: 0.9999005794525146
Max: 0.9998644590377808
Max: 0.9998505115509033
Predsum: 44777
GtSum: 36140
Predsum: 44777
GtSum: 36140
Predsum: 44777
GtSum: 36140
case 2 mean_dice 0.874550 mean_hd95 4.242641
2021-12-14 17:05:30,692 ============================================================
============================================================
2021-12-14 17:05:30,692 Subject 4 out of 10: Prostate3T-01-0029
Subject 4 out of 10: Prostate3T-01-0029
2021-12-14 17:05:33,037 case 3 mean_dice 0.857576 mean_hd95 3.000000
Max: 0.9998646974563599
Max: 0.9998611211776733
Max: 0.9998892545700073
Max: 0.9998339414596558
Max: 0.9998237490653992
Max: 0.9998538494110107
Max: 0.9999934434890747
Max: 0.9999978542327881
Max: 0.999990701675415
Max: 0.9999635219573975
Max: 0.9999790191650391
Max: 0.999950647354126
Max: 0.9999490976333618
Max: 0.9999431371688843
Max: 0.9999164342880249
Max: 0.9998856782913208
Max: 0.999874472618103
Max: 0.9998483657836914
Max: 0.9998956918716431
Max: 0.9999127388000488
Predsum: 58851
GtSum: 46770
Predsum: 58851
GtSum: 46770
Predsum: 58851
GtSum: 46770
case 3 mean_dice 0.857576 mean_hd95 3.000000
2021-12-14 17:05:33,052 ============================================================
============================================================
2021-12-14 17:05:33,052 Subject 5 out of 10: Prostate3T-01-0025
Subject 5 out of 10: Prostate3T-01-0025
2021-12-14 17:05:35,221 case 4 mean_dice 0.885466 mean_hd95 2.449490
Max: 0.9998655319213867
Max: 0.9998588562011719
Max: 0.999836802482605
Max: 0.9998292922973633
Max: 0.9998595714569092
Max: 0.9999004602432251
Max: 0.999961256980896
Max: 0.9999827146530151
Max: 0.9999858140945435
Max: 0.9999276399612427
Max: 0.999966025352478
Max: 0.9999068975448608
Max: 0.9998822212219238
Max: 0.9998708963394165
Max: 0.9998898506164551
Max: 0.9998395442962646
Max: 0.9998039603233337
Max: 0.9998660087585449
Max: 0.999855637550354
Predsum: 55205
GtSum: 46712
Predsum: 55205
GtSum: 46712
Predsum: 55205
GtSum: 46712
case 4 mean_dice 0.885466 mean_hd95 2.449490
2021-12-14 17:05:35,237 ============================================================
============================================================
2021-12-14 17:05:35,237 Subject 6 out of 10: Prostate3T-01-0026
Subject 6 out of 10: Prostate3T-01-0026
2021-12-14 17:05:37,927 Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Max: 0.9998629093170166
Max: 0.9998345375061035
Max: 0.9998540878295898
Max: 0.9999098777770996
Max: 0.9999186992645264
Max: 0.9999732971191406
Max: 0.999825656414032
Max: 0.9999467134475708
Max: 0.9999719858169556
Max: 0.9999697208404541
Max: 0.9998507499694824
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
2021-12-14 17:05:40,290 case 5 mean_dice 0.895201 mean_hd95 6.000000
Max: 0.9998331069946289
Max: 0.99996018409729
Max: 0.9998490810394287
Max: 0.9998453855514526
Max: 0.9999154806137085
Max: 0.9998385906219482
Max: 0.9998874664306641
Max: 0.9998775720596313
Max: 0.9998598098754883
Predsum: 77950
GtSum: 66670
Predsum: 77950
GtSum: 66670
Predsum: 77950
GtSum: 66670
case 5 mean_dice 0.895201 mean_hd95 6.000000
2021-12-14 17:05:40,306 ============================================================
============================================================
2021-12-14 17:05:40,306 Subject 7 out of 10: Prostate3T-01-0023
Subject 7 out of 10: Prostate3T-01-0023
2021-12-14 17:05:42,767 case 6 mean_dice 0.914350 mean_hd95 3.000000
Max: 0.9998694658279419
Max: 0.9998682737350464
Max: 0.9998418092727661
Max: 0.9999349117279053
Max: 0.9999336004257202
Max: 0.9999637603759766
Max: 0.9999653100967407
Max: 0.999968409538269
Max: 0.9999587535858154
Max: 0.9999903440475464
Max: 0.9999397993087769
Max: 0.9999440908432007
Max: 0.9998910427093506
Max: 0.9998359680175781
Max: 0.9998855590820312
Max: 0.9998273849487305
Max: 0.9998019337654114
Max: 0.9998441934585571
Max: 0.9998390674591064
Max: 0.9998480081558228
Predsum: 59143
GtSum: 52066
Predsum: 59143
GtSum: 52066
Predsum: 59143
GtSum: 52066
case 6 mean_dice 0.914350 mean_hd95 3.000000
2021-12-14 17:05:42,782 ============================================================
============================================================
2021-12-14 17:05:42,782 Subject 8 out of 10: Prostate3T-01-0028
Subject 8 out of 10: Prostate3T-01-0028
2021-12-14 17:05:44,543 case 7 mean_dice 0.894641 mean_hd95 3.000000
Max: 0.9998825788497925
Max: 0.9998906850814819
Max: 0.9998798370361328
Max: 0.9998863935470581
Max: 0.9998838901519775
Max: 0.9998281002044678
Max: 0.9998819828033447
Max: 0.9998579025268555
Max: 0.9999035596847534
Max: 0.9999140501022339
Max: 0.9998750686645508
Max: 0.9998764991760254
Max: 0.9998875856399536
Max: 0.9999126195907593
Max: 0.9999161958694458
Predsum: 67711
GtSum: 62520
Predsum: 67711
GtSum: 62520
Predsum: 67711
GtSum: 62520
case 7 mean_dice 0.894641 mean_hd95 3.000000
2021-12-14 17:05:44,557 ============================================================
============================================================
2021-12-14 17:05:44,558 Subject 9 out of 10: Prostate3T-01-0021
Subject 9 out of 10: Prostate3T-01-0021
2021-12-14 17:05:46,869 case 8 mean_dice 0.925389 mean_hd95 2.000000
Max: 0.9999154806137085
Max: 0.9999268054962158
Max: 0.999907374382019
Max: 0.9999409914016724
Max: 0.9999314546585083
Max: 0.9999791383743286
Max: 0.9999833106994629
Max: 0.9999703168869019
Max: 0.9999872446060181
Max: 0.9999876022338867
Max: 0.9999492168426514
Max: 0.9999517202377319
Max: 0.9998297691345215
Max: 0.9998879432678223
Max: 0.9998753070831299
Max: 0.9999403953552246
Max: 0.9998650550842285
Max: 0.9999213218688965
Max: 0.9999023675918579
Max: 0.9998283386230469
Predsum: 74074
GtSum: 66978
Predsum: 74074
GtSum: 66978
Predsum: 74074
GtSum: 66978
case 8 mean_dice 0.925389 mean_hd95 2.000000
2021-12-14 17:05:46,885 ============================================================
============================================================
2021-12-14 17:05:46,885 Subject 10 out of 10: Prostate3T-01-0027
Subject 10 out of 10: Prostate3T-01-0027
2021-12-14 17:05:49,220 case 9 mean_dice 0.896658 mean_hd95 2.828427
Max: 0.9998637437820435
Max: 0.9999431371688843
Max: 0.9998873472213745
Max: 0.9999017715454102
Max: 0.9999322891235352
Max: 0.9998947381973267
Max: 0.9999620914459229
Max: 0.9999943971633911
Max: 0.9999840259552002
Max: 0.9999914169311523
Max: 0.9999861717224121
Max: 0.9999643564224243
Max: 0.9999961853027344
Max: 0.9999462366104126
Max: 0.9998754262924194
Max: 0.9998693466186523
Max: 0.9999008178710938
Max: 0.9998579025268555
Max: 0.9998823404312134
Max: 0.9998682737350464
Predsum: 60220
GtSum: 53596
Predsum: 60220
GtSum: 53596
Predsum: 60220
GtSum: 53596
case 9 mean_dice 0.896658 mean_hd95 2.828427
2021-12-14 17:05:49,221 Mean class 0 mean_dice 0.896830 mean_hd95 3.075663
Mean class 0 mean_dice 0.896830 mean_hd95 3.075663
2021-12-14 17:05:49,221 Mean class 1 mean_dice 0.896830 mean_hd95 3.075663
Mean class 1 mean_dice 0.896830 mean_hd95 3.075663
2021-12-14 17:05:49,221 Mean class 2 mean_dice 0.896830 mean_hd95 3.075663
Mean class 2 mean_dice 0.896830 mean_hd95 3.075663
2021-12-14 17:05:49,221 Testing performance in best val model: mean_dice : 0.896830 mean_hd95 : 3.075663
Testing performance in best val model: mean_dice : 0.896830 mean_hd95 : 3.075663
test.py successfully executed
