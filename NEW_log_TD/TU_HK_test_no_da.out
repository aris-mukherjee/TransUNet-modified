2021-12-03 16:15:39,491 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='HK', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='HK', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/Prostate_PROMISE12/TrainingData/', test_dataset='HK', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='HK', z_spacing=1, is_pretrain=True, exp='TU_RUNMC256')
2021-12-03 16:15:39,491 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2021-12-03 16:15:39,505 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2021-12-03 16:15:50,821 ============================================================
============================================================
2021-12-03 16:15:50,822 Subject 1 out of 10: case44
Subject 1 out of 10: case44
2021-12-03 16:15:53,866 case 0 mean_dice 0.635476 mean_hd95 41.448764
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 19106
GtSum: 26164
Predsum: 19106
GtSum: 26164
Predsum: 19106
GtSum: 26164
case 0 mean_dice 0.635476 mean_hd95 41.448764
2021-12-03 16:15:54,046 ============================================================
============================================================
2021-12-03 16:15:54,046 Subject 2 out of 10: case43
Subject 2 out of 10: case43
2021-12-03 16:15:56,884 case 1 mean_dice 0.608013 mean_hd95 18.275667
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 31091
GtSum: 36026
Predsum: 31091
GtSum: 36026
Predsum: 31091
GtSum: 36026
case 1 mean_dice 0.608013 mean_hd95 18.275667
2021-12-03 16:15:57,035 ============================================================
============================================================
2021-12-03 16:15:57,035 Subject 3 out of 10: case45
Subject 3 out of 10: case45
2021-12-03 16:15:59,819 case 2 mean_dice 0.647546 mean_hd95 39.422075
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 13022
GtSum: 17067
Predsum: 13022
GtSum: 17067
Predsum: 13022
GtSum: 17067
case 2 mean_dice 0.647546 mean_hd95 39.422075
2021-12-03 16:15:59,971 ============================================================
============================================================
2021-12-03 16:15:59,971 Subject 4 out of 10: case47
Subject 4 out of 10: case47
2021-12-03 16:16:02,770 case 3 mean_dice 0.716411 mean_hd95 5.385165
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 21011
GtSum: 24234
Predsum: 21011
GtSum: 24234
Predsum: 21011
GtSum: 24234
case 3 mean_dice 0.716411 mean_hd95 5.385165
2021-12-03 16:16:02,915 ============================================================
============================================================
2021-12-03 16:16:02,916 Subject 5 out of 10: case39
Subject 5 out of 10: case39
2021-12-03 16:16:05,747 case 4 mean_dice 0.726597 mean_hd95 21.512737
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 24988
GtSum: 36917
Predsum: 24988
GtSum: 36917
Predsum: 24988
GtSum: 36917
case 4 mean_dice 0.726597 mean_hd95 21.512737
2021-12-03 16:16:05,891 ============================================================
============================================================
2021-12-03 16:16:05,891 Subject 6 out of 10: case41
Subject 6 out of 10: case41
2021-12-03 16:16:08,631 case 5 mean_dice 0.685473 mean_hd95 4.000000
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 10508
GtSum: 16682
Predsum: 10508
GtSum: 16682
Predsum: 10508
GtSum: 16682
case 5 mean_dice 0.685473 mean_hd95 4.000000
2021-12-03 16:16:08,774 ============================================================
============================================================
2021-12-03 16:16:08,774 Subject 7 out of 10: case46
Subject 7 out of 10: case46
2021-12-03 16:16:11,583 case 6 mean_dice 0.811994 mean_hd95 4.582576
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 26360
GtSum: 28766
Predsum: 26360
GtSum: 28766
Predsum: 26360
GtSum: 28766
case 6 mean_dice 0.811994 mean_hd95 4.582576
2021-12-03 16:16:11,725 ============================================================
============================================================
2021-12-03 16:16:11,725 Subject 8 out of 10: case38
Subject 8 out of 10: case38
2021-12-03 16:16:14,826 case 7 mean_dice 0.830351 mean_hd95 4.123106
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 48247
GtSum: 57583
Predsum: 48247
GtSum: 57583
Predsum: 48247
GtSum: 57583
case 7 mean_dice 0.830351 mean_hd95 4.123106
2021-12-03 16:16:14,969 ============================================================
============================================================
2021-12-03 16:16:14,969 Subject 9 out of 10: case40
Subject 9 out of 10: case40
2021-12-03 16:16:17,786 case 8 mean_dice 0.477283 mean_hd95 23.933210
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 19419
GtSum: 25372
Predsum: 19419
GtSum: 25372
Predsum: 19419
GtSum: 25372
case 8 mean_dice 0.477283 mean_hd95 23.933210
2021-12-03 16:16:17,929 ============================================================
============================================================
2021-12-03 16:16:17,929 Subject 10 out of 10: case42
Subject 10 out of 10: case42
2021-12-03 16:16:20,788 case 9 mean_dice 0.868586 mean_hd95 3.162278
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
torch.Size([1, 3, 256, 256])
Predsum: 68663
GtSum: 80225
Predsum: 68663
GtSum: 80225
Predsum: 68663
GtSum: 80225
case 9 mean_dice 0.868586 mean_hd95 3.162278
2021-12-03 16:16:20,788 Mean class 0 mean_dice 0.700773 mean_hd95 16.584558
Mean class 0 mean_dice 0.700773 mean_hd95 16.584558
2021-12-03 16:16:20,788 Mean class 1 mean_dice 0.700773 mean_hd95 16.584558
Mean class 1 mean_dice 0.700773 mean_hd95 16.584558
2021-12-03 16:16:20,788 Mean class 2 mean_dice 0.700773 mean_hd95 16.584558
Mean class 2 mean_dice 0.700773 mean_hd95 16.584558
2021-12-03 16:16:20,788 Testing performance in best val model: mean_dice : 0.700773 mean_hd95 : 16.584558
Testing performance in best val model: mean_dice : 0.700773 mean_hd95 : 16.584558
test.py successfully executed
