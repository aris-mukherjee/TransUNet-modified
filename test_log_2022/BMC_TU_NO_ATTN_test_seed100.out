2022-01-21 23:38:47,949 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='BMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='BMC', z_spacing=1, is_pretrain=True, exp='TU_BMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='BMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='BMC', z_spacing=1, is_pretrain=True, exp='TU_BMC256')
2022-01-21 23:38:47,950 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2022-01-21 23:38:48,003 Reading BMC images...
Reading BMC images...
2022-01-21 23:38:48,003 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2022-01-21 23:38:48,004 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2022-01-21 23:38:50,218 ============================================================
============================================================
2022-01-21 23:38:50,219 Subject 1 out of 10: ProstateDx-01-0073
Subject 1 out of 10: ProstateDx-01-0073
2022-01-21 23:38:53,967 case 0 mean_dice 0.807287 mean_hd95 64.317571
Predsum: 25519
GtSum: 28987
Predsum: 25519
GtSum: 28987
Predsum: 25519
GtSum: 28987
case 0 mean_dice 0.807287 mean_hd95 64.317571
2022-01-21 23:38:53,992 ============================================================
============================================================
2022-01-21 23:38:53,992 Subject 2 out of 10: ProstateDx-01-0075
Subject 2 out of 10: ProstateDx-01-0075
2022-01-21 23:38:57,560 case 1 mean_dice 0.792939 mean_hd95 13.190906
Predsum: 58207
GtSum: 55547
Predsum: 58207
GtSum: 55547
Predsum: 58207
GtSum: 55547
case 1 mean_dice 0.792939 mean_hd95 13.190906
2022-01-21 23:38:57,585 ============================================================
============================================================
2022-01-21 23:38:57,585 Subject 3 out of 10: ProstateDx-01-0063
Subject 3 out of 10: ProstateDx-01-0063
2022-01-21 23:39:00,753 case 2 mean_dice 0.747909 mean_hd95 12.535940
Predsum: 45134
GtSum: 38197
Predsum: 45134
GtSum: 38197
Predsum: 45134
GtSum: 38197
case 2 mean_dice 0.747909 mean_hd95 12.535940
2022-01-21 23:39:00,776 ============================================================
============================================================
2022-01-21 23:39:00,776 Subject 4 out of 10: ProstateDx-01-0080
Subject 4 out of 10: ProstateDx-01-0080
2022-01-21 23:39:03,889 case 3 mean_dice 0.658993 mean_hd95 8.000000
Predsum: 19792
GtSum: 27553
Predsum: 19792
GtSum: 27553
Predsum: 19792
GtSum: 27553
case 3 mean_dice 0.658993 mean_hd95 8.000000
2022-01-21 23:39:03,910 ============================================================
============================================================
2022-01-21 23:39:03,910 Subject 5 out of 10: ProstateDx-01-0071
Subject 5 out of 10: ProstateDx-01-0071
2022-01-21 23:39:06,983 case 4 mean_dice 0.679599 mean_hd95 4.000000
Predsum: 15593
GtSum: 23483
Predsum: 15593
GtSum: 23483
Predsum: 15593
GtSum: 23483
case 4 mean_dice 0.679599 mean_hd95 4.000000
2022-01-21 23:39:07,007 ============================================================
============================================================
2022-01-21 23:39:07,007 Subject 6 out of 10: ProstateDx-01-0074
Subject 6 out of 10: ProstateDx-01-0074
2022-01-21 23:39:10,277 case 5 mean_dice 0.855927 mean_hd95 3.741657
Predsum: 20927
GtSum: 18317
Predsum: 20927
GtSum: 18317
Predsum: 20927
GtSum: 18317
case 5 mean_dice 0.855927 mean_hd95 3.741657
2022-01-21 23:39:10,300 ============================================================
============================================================
2022-01-21 23:39:10,300 Subject 7 out of 10: ProstateDx-01-0082
Subject 7 out of 10: ProstateDx-01-0082
2022-01-21 23:39:12,029 case 6 mean_dice 1.000000 mean_hd95 0.000000
Predsum: 80906
GtSum: 0
Predsum: 80906
GtSum: 0
Predsum: 80906
GtSum: 0
case 6 mean_dice 1.000000 mean_hd95 0.000000
2022-01-21 23:39:12,050 ============================================================
============================================================
2022-01-21 23:39:12,050 Subject 8 out of 10: ProstateDx-01-0060
Subject 8 out of 10: ProstateDx-01-0060
2022-01-21 23:39:15,347 case 7 mean_dice 0.848196 mean_hd95 5.000000
Predsum: 84403
GtSum: 85560
Predsum: 84403
GtSum: 85560
Predsum: 84403
GtSum: 85560
case 7 mean_dice 0.848196 mean_hd95 5.000000
2022-01-21 23:39:15,369 ============================================================
============================================================
2022-01-21 23:39:15,370 Subject 9 out of 10: ProstateDx-01-0076
Subject 9 out of 10: ProstateDx-01-0076
2022-01-21 23:39:18,616 case 8 mean_dice 0.818803 mean_hd95 15.297059
Predsum: 32481
GtSum: 29148
Predsum: 32481
GtSum: 29148
Predsum: 32481
GtSum: 29148
case 8 mean_dice 0.818803 mean_hd95 15.297059
2022-01-21 23:39:18,639 ============================================================
============================================================
2022-01-21 23:39:18,640 Subject 10 out of 10: ProstateDx-01-0059
Subject 10 out of 10: ProstateDx-01-0059
2022-01-21 23:39:21,751 case 9 mean_dice 0.812046 mean_hd95 5.000000
Predsum: 24254
GtSum: 25423
Predsum: 24254
GtSum: 25423
Predsum: 24254
GtSum: 25423
case 9 mean_dice 0.812046 mean_hd95 5.000000
2022-01-21 23:39:21,751 Mean class 0 mean_dice 0.802170 mean_hd95 13.108313
Mean class 0 mean_dice 0.802170 mean_hd95 13.108313
2022-01-21 23:39:21,751 Mean class 1 mean_dice 0.802170 mean_hd95 13.108313
Mean class 1 mean_dice 0.802170 mean_hd95 13.108313
2022-01-21 23:39:21,751 Mean class 2 mean_dice 0.802170 mean_hd95 13.108313
Mean class 2 mean_dice 0.802170 mean_hd95 13.108313
2022-01-21 23:39:21,751 Testing performance in best val model: mean_dice : 0.802170 mean_hd95 : 13.108313
Testing performance in best val model: mean_dice : 0.802170 mean_hd95 : 13.108313
test.py successfully executed
