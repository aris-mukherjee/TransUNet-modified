2022-01-22 16:49:07,183 Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='BMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='BMC', z_spacing=1, is_pretrain=True, exp='TU_BMC256')
Namespace(volume_path='/itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/', test_dataset='BMC', num_classes=3, max_iterations=6800, max_epochs=400, batch_size=16, img_size=256, is_savenii=True, n_skip=3, vit_name='R50-ViT-B_16', test_save_dir='../predictions', deterministic=1, base_lr=0.001, seed=1234, vit_patches_size=16, target_resolution=0.625, image_depth_tr=32, image_depth_ts=32, test_cv_fold_num=1, NORMALIZE=1, Dataset='BMC', z_spacing=1, is_pretrain=True, exp='TU_BMC256')
2022-01-22 16:49:07,184 TU_pretrain_R50-ViT-B_16_skip3_bs16_256
TU_pretrain_R50-ViT-B_16_skip3_bs16_256
2022-01-22 16:49:07,197 Reading BMC images...
Reading BMC images...
2022-01-22 16:49:07,197 Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
Data root directory: /itet-stor/arismu/bmicdatasets-originals/Originals/Challenge_Datasets/NCI_Prostate/
2022-01-22 16:49:07,198 Already preprocessed this configuration. Loading now!
Already preprocessed this configuration. Loading now!
2022-01-22 16:49:09,419 ============================================================
============================================================
2022-01-22 16:49:09,419 Subject 1 out of 10: ProstateDx-01-0073
Subject 1 out of 10: ProstateDx-01-0073
2022-01-22 16:49:13,227 case 0 mean_dice 0.760071 mean_hd95 80.808415
Predsum: 37762
GtSum: 28987
Predsum: 37762
GtSum: 28987
Predsum: 37762
GtSum: 28987
case 0 mean_dice 0.760071 mean_hd95 80.808415
2022-01-22 16:49:13,258 ============================================================
============================================================
2022-01-22 16:49:13,258 Subject 2 out of 10: ProstateDx-01-0075
Subject 2 out of 10: ProstateDx-01-0075
2022-01-22 16:49:16,729 case 1 mean_dice 0.828994 mean_hd95 17.691806
Predsum: 68022
GtSum: 55547
Predsum: 68022
GtSum: 55547
Predsum: 68022
GtSum: 55547
case 1 mean_dice 0.828994 mean_hd95 17.691806
2022-01-22 16:49:16,756 ============================================================
============================================================
2022-01-22 16:49:16,756 Subject 3 out of 10: ProstateDx-01-0063
Subject 3 out of 10: ProstateDx-01-0063
2022-01-22 16:49:20,156 case 2 mean_dice 0.812998 mean_hd95 5.916080
Predsum: 43813
GtSum: 38197
Predsum: 43813
GtSum: 38197
Predsum: 43813
GtSum: 38197
case 2 mean_dice 0.812998 mean_hd95 5.916080
2022-01-22 16:49:20,184 ============================================================
============================================================
2022-01-22 16:49:20,184 Subject 4 out of 10: ProstateDx-01-0080
Subject 4 out of 10: ProstateDx-01-0080
2022-01-22 16:49:23,358 case 3 mean_dice 0.650070 mean_hd95 5.000000
Predsum: 19725
GtSum: 27553
Predsum: 19725
GtSum: 27553
Predsum: 19725
GtSum: 27553
case 3 mean_dice 0.650070 mean_hd95 5.000000
2022-01-22 16:49:23,384 ============================================================
============================================================
2022-01-22 16:49:23,384 Subject 5 out of 10: ProstateDx-01-0071
Subject 5 out of 10: ProstateDx-01-0071
2022-01-22 16:49:26,909 case 4 mean_dice 0.750178 mean_hd95 6.557439
Predsum: 21341
GtSum: 23483
Predsum: 21341
GtSum: 23483
Predsum: 21341
GtSum: 23483
case 4 mean_dice 0.750178 mean_hd95 6.557439
2022-01-22 16:49:26,937 ============================================================
============================================================
2022-01-22 16:49:26,937 Subject 6 out of 10: ProstateDx-01-0074
Subject 6 out of 10: ProstateDx-01-0074
2022-01-22 16:49:30,327 case 5 mean_dice 0.776930 mean_hd95 82.152298
Predsum: 25965
GtSum: 18317
Predsum: 25965
GtSum: 18317
Predsum: 25965
GtSum: 18317
case 5 mean_dice 0.776930 mean_hd95 82.152298
2022-01-22 16:49:30,353 ============================================================
============================================================
2022-01-22 16:49:30,353 Subject 7 out of 10: ProstateDx-01-0082
Subject 7 out of 10: ProstateDx-01-0082
2022-01-22 16:49:32,012 case 6 mean_dice 1.000000 mean_hd95 0.000000
Predsum: 83815
GtSum: 0
Predsum: 83815
GtSum: 0
Predsum: 83815
GtSum: 0
case 6 mean_dice 1.000000 mean_hd95 0.000000
2022-01-22 16:49:32,038 ============================================================
============================================================
2022-01-22 16:49:32,038 Subject 8 out of 10: ProstateDx-01-0060
Subject 8 out of 10: ProstateDx-01-0060
2022-01-22 16:49:35,406 case 7 mean_dice 0.858524 mean_hd95 5.385165
Predsum: 82992
GtSum: 85560
Predsum: 82992
GtSum: 85560
Predsum: 82992
GtSum: 85560
case 7 mean_dice 0.858524 mean_hd95 5.385165
2022-01-22 16:49:35,433 ============================================================
============================================================
2022-01-22 16:49:35,433 Subject 9 out of 10: ProstateDx-01-0076
Subject 9 out of 10: ProstateDx-01-0076
2022-01-22 16:49:38,808 case 8 mean_dice 0.801898 mean_hd95 70.178344
Predsum: 32381
GtSum: 29148
Predsum: 32381
GtSum: 29148
Predsum: 32381
GtSum: 29148
case 8 mean_dice 0.801898 mean_hd95 70.178344
2022-01-22 16:49:38,835 ============================================================
============================================================
2022-01-22 16:49:38,835 Subject 10 out of 10: ProstateDx-01-0059
Subject 10 out of 10: ProstateDx-01-0059
2022-01-22 16:49:42,060 case 9 mean_dice 0.793507 mean_hd95 66.219333
Predsum: 27615
GtSum: 25423
Predsum: 27615
GtSum: 25423
Predsum: 27615
GtSum: 25423
case 9 mean_dice 0.793507 mean_hd95 66.219333
2022-01-22 16:49:42,060 Mean class 0 mean_dice 0.803317 mean_hd95 33.990888
Mean class 0 mean_dice 0.803317 mean_hd95 33.990888
2022-01-22 16:49:42,060 Mean class 1 mean_dice 0.803317 mean_hd95 33.990888
Mean class 1 mean_dice 0.803317 mean_hd95 33.990888
2022-01-22 16:49:42,060 Mean class 2 mean_dice 0.803317 mean_hd95 33.990888
Mean class 2 mean_dice 0.803317 mean_hd95 33.990888
2022-01-22 16:49:42,060 Testing performance in best val model: mean_dice : 0.803317 mean_hd95 : 33.990888
Testing performance in best val model: mean_dice : 0.803317 mean_hd95 : 33.990888
test.py successfully executed
